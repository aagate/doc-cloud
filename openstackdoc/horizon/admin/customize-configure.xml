<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/horizon/doc/source/admin/customize-configure.rst">
    <section ids="customize-and-configure-the-dashboard" names="customize\ and\ configure\ the\ dashboard">
        <title>Customize and configure the Dashboard</title>
        <paragraph>Once you have the Dashboard installed, you can customize the way
            it looks and feels to suit the needs of your environment, your
            project, or your business.</paragraph>
        <paragraph>You can also configure the Dashboard for a secure HTTPS deployment, or
            an HTTP deployment. The standard OpenStack installation uses a non-encrypted
            HTTP channel, but you can enable SSL support for the Dashboard.</paragraph>
        <paragraph>For information on configuring HTTPS or HTTP, see <reference internal="True" refid="configure-dashboard"><inline classes="std std-ref">Configure the Dashboard</inline></reference>.</paragraph>
        <comment xml:space="preserve">This content is out of date as of the Mitaka release, and needs an</comment>
        <comment xml:space="preserve">update to reflect the most recent work on themeing - JR -.</comment>
        <section ids="customize-the-dashboard" names="customize\ the\ dashboard">
            <title>Customize the Dashboard</title>
            <paragraph>The OpenStack Dashboard on Ubuntu installs the
                <literal>openstack-dashboard-ubuntu-theme</literal> package by default. If you do not
                want to use this theme, remove it and its dependencies:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># apt-get remove --auto-remove openstack-dashboard-ubuntu-theme</literal_block>
            <note>
                <paragraph>This guide focuses on the <literal>local_settings.py</literal> file.</paragraph>
            </note>
            <paragraph>The following Dashboard content can be customized to suit your needs:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Logo</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Site colors</paragraph>
                </list_item>
                <list_item>
                    <paragraph>HTML title</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Logo link</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Help URL</paragraph>
                </list_item>
            </bullet_list>
            <section ids="logo-and-site-colors" names="logo\ and\ site\ colors">
                <title>Logo and site colors</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Create two PNG logo files with transparent backgrounds using
                            the following sizes:</paragraph>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>Login screen: 365 x 50</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>Logged in banner: 216 x 35</paragraph>
                            </list_item>
                        </bullet_list>
                    </list_item>
                    <list_item>
                        <paragraph>Upload your new images to
                            <literal>/usr/share/openstack-dashboard/openstack_dashboard/static/dashboard/img/</literal>.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a CSS style sheet in
                            <literal>/usr/share/openstack-dashboard/openstack_dashboard/static/dashboard/scss/</literal>.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Change the colors and image file names as appropriate. Ensure the
                            relative directory paths are the same. The following example file
                            shows you how to customize your CSS file:</paragraph>
                        <literal_block highlight_args="{}" language="css" linenos="False" xml:space="preserve">/*
* New theme colors for dashboard that override the defaults:
*  dark blue: #355796 / rgb(53, 87, 150)
*  light blue: #BAD3E1 / rgb(186, 211, 225)
*
* By Preston Lee &lt;plee@tgen.org&gt;
*/
h1.brand {
background: #355796 repeat-x top left;
border-bottom: 2px solid #BAD3E1;
}
h1.brand a {
background: url(../img/my_cloud_logo_small.png) top left no-repeat;
}
#splash .login {
background: #355796 url(../img/my_cloud_logo_medium.png) no-repeat center 35px;
}
#splash .login .modal-header {
border-top: 1px solid #BAD3E1;
}
.btn-primary {
background-image: none !important;
background-color: #355796 !important;
border: none !important;
box-shadow: none;
}
.btn-primary:hover,
.btn-primary:active {
border: none;
box-shadow: none;
background-color: #BAD3E1 !important;
text-decoration: none;
}</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Open the following HTML template in an editor of your choice:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">/usr/share/openstack-dashboard/openstack_dashboard/templates/_stylesheets.html</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Add a line to include your newly created style sheet. For example,
                            <literal>custom.css</literal> file:</paragraph>
                        <literal_block highlight_args="{}" language="html" linenos="False" xml:space="preserve">&lt;link href='{{ STATIC_URL }}bootstrap/css/bootstrap.min.css' media='screen' rel='stylesheet' /&gt;
&lt;link href='{{ STATIC_URL }}dashboard/css/{% choose_css %}' media='screen' rel='stylesheet' /&gt;
&lt;link href='{{ STATIC_URL }}dashboard/css/custom.css' media='screen' rel='stylesheet' /&gt;</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Restart the Apache service.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>To view your changes, reload your Dashboard. If necessary, go back
                            and modify your CSS file as appropriate.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
            <section ids="html-title" names="html\ title">
                <title>HTML title</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Set the HTML title, which appears at the top of the browser window, by
                            adding the following line to <literal>local_settings.py</literal>:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SITE_BRANDING = "Example, Inc. Cloud"</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Restart Apache for this change to take effect.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
            <section ids="logo-link" names="logo\ link">
                <title>Logo link</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>The logo also acts as a hyperlink. The default behavior is to redirect
                            to <literal>horizon:user_home</literal>. To change this, add the following attribute to
                            <literal>local_settings.py</literal>:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SITE_BRANDING_LINK = "http://example.com"</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Restart Apache for this change to take effect.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
            <section ids="help-url" names="help\ url">
                <title>Help URL</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>By default, the help URL points to <reference refuri="https://docs.openstack.org">https://docs.openstack.org</reference>. To change
                            this, edit the following attribute in <literal>local_settings.py</literal>:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">HORIZON_CONFIG["help_url"] = "http://openstack.mycompany.org"</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Restart Apache for this change to take effect.</paragraph>
                    </list_item>
                </enumerated_list>
                <target refid="configure-dashboard"></target>
            </section>
        </section>
        <section ids="configure-the-dashboard configure-dashboard" names="configure\ the\ dashboard configure_dashboard">
            <title>Configure the Dashboard</title>
            <paragraph>The following section on configuring the Dashboard for a
                secure HTTPS deployment, or a HTTP deployment, uses concrete
                examples to ensure the procedure is clear. The file path varies
                by distribution, however. If needed, you can also configure
                the VNC window size in the Dashboard.</paragraph>
            <section ids="configure-the-dashboard-for-http" names="configure\ the\ dashboard\ for\ http">
                <title>Configure the Dashboard for HTTP</title>
                <paragraph>You can configure the Dashboard for a simple HTTP deployment.
                    The standard installation uses a non-encrypted HTTP channel.</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Specify the host for your Identity service endpoint in the
                            <literal>local_settings.py</literal> file with the <literal>OPENSTACK_HOST</literal> setting.</paragraph>
                        <paragraph>The following example shows this setting:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">import os

from django.utils.translation import ugettext_lazy as _

DEBUG = False
TEMPLATE_DEBUG = DEBUG
PROD = True
USE_SSL = False

SITE_BRANDING = 'OpenStack Dashboard'

# Ubuntu-specific: Enables an extra panel in the 'Settings' section
# that easily generates a Juju environments.yaml for download,
# preconfigured with endpoints and credentials required for bootstrap
# and service deployment.
ENABLE_JUJU_PANEL = True

# Note: You should change this value
SECRET_KEY = 'elj1IWiLoWHgryYxFT6j7cM5fGOOxWY0'

# Specify a regular expression to validate user passwords.
# HORIZON_CONFIG = {
#     "password_validator": {
#         "regex": '.*',
#         "help_text": _("Your password does not meet the requirements.")
#     }
# }

LOCAL_PATH = os.path.dirname(os.path.abspath(__file__))

CACHES = {
    'default': {
        'BACKEND' : 'django.core.cache.backends.memcached.MemcachedCache',
        'LOCATION' : '127.0.0.1:11211'
    }
}

# Send email to the console by default
EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'
# Or send them to /dev/null
#EMAIL_BACKEND = 'django.core.mail.backends.dummy.EmailBackend'

# Configure these for your outgoing email host
# EMAIL_HOST = 'smtp.my-company.com'
# EMAIL_PORT = 25
# EMAIL_HOST_USER = 'djangomail'
# EMAIL_HOST_PASSWORD = 'top-secret!'

# For multiple regions uncomment this configuration, and add (endpoint, title).
# AVAILABLE_REGIONS = [
#     ('http://cluster1.example.com:5000/v2.0', 'cluster1'),
#     ('http://cluster2.example.com:5000/v2.0', 'cluster2'),
# ]

OPENSTACK_HOST = "127.0.0.1"
OPENSTACK_KEYSTONE_URL = "http://%s:5000/v2.0" % OPENSTACK_HOST
OPENSTACK_KEYSTONE_DEFAULT_ROLE = "Member"

# The OPENSTACK_KEYSTONE_BACKEND settings can be used to identify the
# capabilities of the auth backend for Keystone.
# If Keystone has been configured to use LDAP as the auth backend then set
# can_edit_user to False and name to 'ldap'.
#
# TODO(tres): Remove these once Keystone has an API to identify auth backend.
OPENSTACK_KEYSTONE_BACKEND = {
    'name': 'native',
    'can_edit_user': True
}

# OPENSTACK_ENDPOINT_TYPE specifies the endpoint type to use for the endpoints
# in the Keystone service catalog. Use this setting when Horizon is running
# external to the OpenStack environment. The default is 'internalURL'.
#OPENSTACK_ENDPOINT_TYPE = "publicURL"

# The number of Swift containers and objects to display on a single page before
# providing a paging element (a "more" link) to paginate results.
API_RESULT_LIMIT = 1000

# If you have external monitoring links, eg:
# EXTERNAL_MONITORING = [
#     ['Nagios','http://foo.com'],
#     ['Ganglia','http://bar.com'],
# ]

LOGGING = {
        'version': 1,
        # When set to True this will disable all logging except
        # for loggers specified in this configuration dictionary. Note that
        # if nothing is specified here and disable_existing_loggers is True,
        # django.db.backends will still log unless it is disabled explicitly.
        'disable_existing_loggers': False,
        'handlers': {
            'null': {
                'level': 'DEBUG',
                'class': 'logging.NullHandler',
                },
            'console': {
                # Set the level to "DEBUG" for verbose output logging.
                'level': 'INFO',
                'class': 'logging.StreamHandler',
                },
            },
        'loggers': {
            # Logging from django.db.backends is VERY verbose, send to null
            # by default.
            'django.db.backends': {
                'handlers': ['null'],
                'propagate': False,
                },
            'horizon': {
                'handlers': ['console'],
                'propagate': False,
            },
            'novaclient': {
                'handlers': ['console'],
                'propagate': False,
            },
            'keystoneclient': {
                'handlers': ['console'],
                'propagate': False,
            },
            'nose.plugins.manager': {
                'handlers': ['console'],
                'propagate': False,
            }
        }
}</literal_block>
                        <paragraph>The service catalog configuration in the Identity service determines
                            whether a service appears in the Dashboard.
                            For the full listing, see <reference internal="True" refuri="../configuration/settings#install-settings"><inline classes="std std-ref">Settings Reference</inline></reference>.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Restart the Apache HTTP Server.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Restart <literal>memcached</literal>.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
            <section ids="configure-the-dashboard-for-https" names="configure\ the\ dashboard\ for\ https">
                <title>Configure the Dashboard for HTTPS</title>
                <paragraph>You can configure the Dashboard for a secured HTTPS deployment.
                    While the standard installation uses a non-encrypted HTTP channel,
                    you can enable SSL support for the Dashboard.</paragraph>
                <paragraph>This example uses the <literal>http://openstack.example.com</literal> domain.
                    Use a domain that fits your current setup.</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>In the <literal>local_settings.py</literal> file, update the following options:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">USE_SSL = True
CSRF_COOKIE_SECURE = True
SESSION_COOKIE_SECURE = True
SESSION_COOKIE_HTTPONLY = True</literal_block>
                        <paragraph>To enable HTTPS, the <literal>USE_SSL = True</literal> option is required.</paragraph>
                        <paragraph>The other options require that HTTPS is enabled;
                            these options defend against cross-site scripting.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Edit the <literal>openstack-dashboard.conf</literal> file as shown in the
                            <strong>Example After</strong>:</paragraph>
                        <paragraph><strong>Example Before</strong></paragraph>
                        <literal_block highlight_args="{}" language="apacheconf" linenos="False" xml:space="preserve">WSGIScriptAlias / /usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi
WSGIDaemonProcess horizon user=www-data group=www-data processes=3 threads=10
Alias /static /usr/share/openstack-dashboard/openstack_dashboard/static/
&lt;Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi&gt;
# For Apache http server 2.2 and earlier:
Order allow,deny
Allow from all

# For Apache http server 2.4 and later:
# Require all granted
&lt;/Directory&gt;</literal_block>
                        <paragraph><strong>Example After</strong></paragraph>
                        <literal_block highlight_args="{}" language="none" linenos="False" xml:space="preserve">&lt;VirtualHost *:80&gt;
ServerName openstack.example.com
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
&lt;/IfModule&gt;
&lt;IfModule !mod_rewrite.c&gt;
RedirectPermanent / https://openstack.example.com
&lt;/IfModule&gt;
&lt;/VirtualHost&gt;
&lt;VirtualHost *:443&gt;
ServerName openstack.example.com

SSLEngine On
# Remember to replace certificates and keys with valid paths in your environment
SSLCertificateFile /etc/apache2/SSL/openstack.example.com.crt
SSLCACertificateFile /etc/apache2/SSL/openstack.example.com.crt
SSLCertificateKeyFile /etc/apache2/SSL/openstack.example.com.key
SetEnvIf User-Agent ".*MSIE.*" nokeepalive ssl-unclean-shutdown

# HTTP Strict Transport Security (HSTS) enforces that all communications
# with a server go over SSL. This mitigates the threat from attacks such
# as SSL-Strip which replaces links on the wire, stripping away https prefixes
# and potentially allowing an attacker to view confidential information on the
# wire
Header add Strict-Transport-Security "max-age=15768000"

WSGIScriptAlias / /usr/share/openstack-dashboard/openstack_dashboard/wsgi/django.wsgi
WSGIDaemonProcess horizon user=www-data group=www-data processes=3 threads=10
Alias /static /usr/share/openstack-dashboard/openstack_dashboard/static/
&lt;Directory /usr/share/openstack-dashboard/openstack_dashboard/wsgi&gt;
# For Apache http server 2.2 and earlier:
    &lt;ifVersion &lt;2.4&gt;
        Order allow,deny
        Allow from all
    &lt;/ifVersion&gt;
# For Apache http server 2.4 and later:
    &lt;ifVersion &gt;=2.4&gt;
#The following two lines have been added by bms for error "AH01630: client denied
#by server configuration:
#/usr/share/openstack-dashboard/openstack_dashboard/static/dashboard/cssa"
        Options All
        AllowOverride All
        Require all granted
    &lt;/ifVersion&gt;
&lt;/Directory&gt;
&lt;Directory /usr/share/openstack-dashboard/static&gt;
    &lt;ifVersion &gt;=2.4&gt;
        Options All
        AllowOverride All
        Require all granted
    &lt;/ifVersion&gt;
&lt;/Directory&gt;
&lt;/VirtualHost&gt;</literal_block>
                        <paragraph>In this configuration, the Apache HTTP Server listens on port 443 and
                            redirects all non-secure requests to the HTTPS protocol. The secured
                            section defines the private key, public key, and certificate to use.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Restart the Apache HTTP Server.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Restart <literal>memcached</literal>.</paragraph>
                        <paragraph>If you try to access the Dashboard through HTTP, the browser redirects
                            you to the HTTPS page.</paragraph>
                        <note>
                            <paragraph>Configuring the Dashboard for HTTPS also requires enabling SSL for
                                the noVNC proxy service. On the controller node, add the following
                                additional options to the <literal>[DEFAULT]</literal> section of the
                                <literal>/etc/nova/nova.conf</literal> file:</paragraph>
                            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
# ...
ssl_only = true
cert = /etc/apache2/SSL/openstack.example.com.crt
key = /etc/apache2/SSL/openstack.example.com.key</literal_block>
                            <paragraph>On the compute nodes, ensure the <literal>nonvncproxy_base_url</literal> option
                                points to a URL with an HTTPS scheme:</paragraph>
                            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
# ...
novncproxy_base_url = https://controller:6080/vnc_auto.html</literal_block>
                        </note>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
    </section>
</document>
