<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/contributor/api/cinder.interface.volume_consistencygroup_driver.rst">
    <section ids="module-cinder.interface.volume_consistencygroup_driver the-cinder-interface-volume-consistencygroup-driver-module" names="the\ cinder.interface.volume_consistencygroup_driver\ module">
        <title>The <reference internal="True" reftitle="cinder.interface.volume_consistencygroup_driver" refuri="../drivers#module-cinder.interface.volume_consistencygroup_driver"><literal classes="xref py py-mod">cinder.interface.volume_consistencygroup_driver</literal></reference> Module</title>
        <index entries="['single',\ 'cinder.interface.volume_consistencygroup_driver\ (module)',\ 'module-cinder.interface.volume_consistencygroup_driver',\ '',\ None]"></index>
        <paragraph>Consistency group volume driver interface.</paragraph>
        <index entries="['single',\ 'VolumeConsistencyGroupDriver\ (class\ in\ cinder.interface.volume_consistencygroup_driver)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver',\ '',\ None]"></index>
        <desc desctype="class" domain="py" noindex="False" objtype="class">
            <desc_signature class="" first="False" fullname="VolumeConsistencyGroupDriver" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver"><desc_annotation xml:space="preserve">class </desc_annotation><desc_name xml:space="preserve">VolumeConsistencyGroupDriver</desc_name></desc_signature>
            <desc_content>
                <paragraph>Bases: <reference internal="True" reftitle="cinder.interface.base.CinderInterface" refuri="cinder.interface.base#cinder.interface.base.CinderInterface"><literal classes="xref py py-class">cinder.interface.base.CinderInterface</literal></reference></paragraph>
                <paragraph>Interface for drivers that support consistency groups.</paragraph>
                <index entries="['single',\ 'create_cgsnapshot()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_cgsnapshot',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.create_cgsnapshot" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_cgsnapshot" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_cgsnapshot"><desc_name xml:space="preserve">create_cgsnapshot</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">cgsnapshot</desc_parameter><desc_parameter xml:space="preserve">snapshots</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Creates a cgsnapshot.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">cgsnapshot</literal_strong> – the dictionary of the cgsnapshot to be created.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">snapshots</literal_strong> – a list of snapshot dictionaries in the cgsnapshot.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update, snapshots_model_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>param snapshots is retrieved directly from the db. It is a list of
                            cinder.db.sqlalchemy.models.Snapshot to be precise. It cannot be
                            assigned to snapshots_model_update. snapshots_model_update is a list
                            of dictionaries. It has to be built by the driver. An entry will be
                            in this format: {‘id’: xxx, ‘status’: xxx, ……}. model_update
                            will be in this format: {‘status’: xxx, ……}.</paragraph>
                        <paragraph>The driver should populate snapshots_model_update and model_update
                            and return them.</paragraph>
                        <paragraph>The manager will check snapshots_model_update and update db accordingly
                            for each snapshot. If the driver successfully deleted some snapshots
                            but failed to delete others, it should set statuses of the snapshots
                            accordingly so that the manager can update db correctly.</paragraph>
                        <paragraph>If the status in any entry of snapshots_model_update is ‘error’, the
                            status in model_update will be set to the same if it is not already
                            ‘error’.</paragraph>
                        <paragraph>If the status in model_update is ‘error’, the manager will raise an
                            exception and the status of cgsnapshot will be set to ‘error’ in the
                            db. If snapshots_model_update is not returned by the driver, the
                            manager will set the status of every snapshot to ‘error’ in the except
                            block.</paragraph>
                        <paragraph>If the driver raises an exception during the operation, it will be
                            caught by the try-except block in the manager and the statuses of
                            cgsnapshot and all snapshots will be set to ‘error’.</paragraph>
                        <paragraph>For a successful operation, the driver can either build the
                            model_update and snapshots_model_update and return them or
                            return None, None. The statuses of cgsnapshot and all snapshots
                            will be set to ‘available’ at the end of the manager function.</paragraph>
                    </desc_content>
                </desc>
                <index entries="['single',\ 'create_consistencygroup()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.create_consistencygroup" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup"><desc_name xml:space="preserve">create_consistencygroup</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">group</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Creates a consistencygroup.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">group</literal_strong> – the dictionary of the consistency group to be created.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>model_update will be in this format: {‘status’: xxx, ……}.</paragraph>
                        <paragraph>If the status in model_update is ‘error’, the manager will throw
                            an exception and it will be caught in the try-except block in the
                            manager. If the driver throws an exception, the manager will also
                            catch it in the try-except block. The group status in the db will
                            be changed to ‘error’.</paragraph>
                        <paragraph>For a successful operation, the driver can either build the
                            model_update and return it or return None. The group status will
                            be set to ‘available’.</paragraph>
                    </desc_content>
                </desc>
                <index entries="['single',\ 'create_consistencygroup_from_src()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup_from_src',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.create_consistencygroup_from_src" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup_from_src" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.create_consistencygroup_from_src"><desc_name xml:space="preserve">create_consistencygroup_from_src</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">group</desc_parameter><desc_parameter xml:space="preserve">volumes</desc_parameter><desc_parameter xml:space="preserve">cgsnapshot=None</desc_parameter><desc_parameter xml:space="preserve">snapshots=None</desc_parameter><desc_parameter xml:space="preserve">source_cg=None</desc_parameter><desc_parameter xml:space="preserve">source_vols=None</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Creates a consistencygroup from source.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">group</literal_strong> – the dictionary of the consistency group to be created.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">volumes</literal_strong> – a list of volume dictionaries in the group.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">cgsnapshot</literal_strong> – the dictionary of the cgsnapshot as source.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">snapshots</literal_strong> – a list of snapshot dictionaries in the cgsnapshot.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">source_cg</literal_strong> – the dictionary of a consistency group as source.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">source_vols</literal_strong> – a list of volume dictionaries in the source_cg.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update, volumes_model_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>The source can be cgsnapshot or a source cg.</paragraph>
                        <paragraph>param volumes is retrieved directly from the db. It is a list of
                            cinder.db.sqlalchemy.models.Volume to be precise. It cannot be
                            assigned to volumes_model_update. volumes_model_update is a list of
                            dictionaries. It has to be built by the driver. An entry will be
                            in this format: {‘id’: xxx, ‘status’: xxx, ……}. model_update
                            will be in this format: {‘status’: xxx, ……}.</paragraph>
                        <paragraph>To be consistent with other volume operations, the manager will
                            assume the operation is successful if no exception is thrown by
                            the driver. For a successful operation, the driver can either build
                            the model_update and volumes_model_update and return them or
                            return None, None.</paragraph>
                    </desc_content>
                </desc>
                <index entries="['single',\ 'delete_cgsnapshot()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_cgsnapshot',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.delete_cgsnapshot" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_cgsnapshot" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_cgsnapshot"><desc_name xml:space="preserve">delete_cgsnapshot</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">cgsnapshot</desc_parameter><desc_parameter xml:space="preserve">snapshots</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Deletes a cgsnapshot.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">cgsnapshot</literal_strong> – the dictionary of the cgsnapshot to be deleted.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">snapshots</literal_strong> – a list of snapshot dictionaries in the cgsnapshot.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update, snapshots_model_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>param snapshots is retrieved directly from the db. It is a list of
                            cinder.db.sqlalchemy.models.Snapshot to be precise. It cannot be
                            assigned to snapshots_model_update. snapshots_model_update is a list
                            of dictionaries. It has to be built by the driver. An entry will be
                            in this format: {‘id’: xxx, ‘status’: xxx, ……}. model_update
                            will be in this format: {‘status’: xxx, ……}.</paragraph>
                        <paragraph>The driver should populate snapshots_model_update and model_update
                            and return them.</paragraph>
                        <paragraph>The manager will check snapshots_model_update and update db accordingly
                            for each snapshot. If the driver successfully deleted some snapshots
                            but failed to delete others, it should set statuses of the snapshots
                            accordingly so that the manager can update db correctly.</paragraph>
                        <paragraph>If the status in any entry of snapshots_model_update is
                            ‘error_deleting’ or ‘error’, the status in model_update will be set to
                            the same if it is not already ‘error_deleting’ or ‘error’.</paragraph>
                        <paragraph>If the status in model_update is ‘error_deleting’ or ‘error’, the
                            manager will raise an exception and the status of cgsnapshot will be
                            set to ‘error’ in the db. If snapshots_model_update is not returned by
                            the driver, the manager will set the status of every snapshot to
                            ‘error’ in the except block.</paragraph>
                        <paragraph>If the driver raises an exception during the operation, it will be
                            caught by the try-except block in the manager and the statuses of
                            cgsnapshot and all snapshots will be set to ‘error’.</paragraph>
                        <paragraph>For a successful operation, the driver can either build the
                            model_update and snapshots_model_update and return them or
                            return None, None. The statuses of cgsnapshot and all snapshots
                            will be set to ‘deleted’ after the manager deletes them from db.</paragraph>
                    </desc_content>
                </desc>
                <index entries="['single',\ 'delete_consistencygroup()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_consistencygroup',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.delete_consistencygroup" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_consistencygroup" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.delete_consistencygroup"><desc_name xml:space="preserve">delete_consistencygroup</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">group</desc_parameter><desc_parameter xml:space="preserve">volumes</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Deletes a consistency group.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">group</literal_strong> – the dictionary of the consistency group to be deleted.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">volumes</literal_strong> – a list of volume dictionaries in the group.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update, volumes_model_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>param volumes is retrieved directly from the db. It is a list of
                            cinder.db.sqlalchemy.models.Volume to be precise. It cannot be
                            assigned to volumes_model_update. volumes_model_update is a list of
                            dictionaries. It has to be built by the driver. An entry will be
                            in this format: {‘id’: xxx, ‘status’: xxx, ……}. model_update
                            will be in this format: {‘status’: xxx, ……}.</paragraph>
                        <paragraph>The driver should populate volumes_model_update and model_update
                            and return them.</paragraph>
                        <paragraph>The manager will check volumes_model_update and update db accordingly
                            for each volume. If the driver successfully deleted some volumes
                            but failed to delete others, it should set statuses of the volumes
                            accordingly so that the manager can update db correctly.</paragraph>
                        <paragraph>If the status in any entry of volumes_model_update is ‘error_deleting’
                            or ‘error’, the status in model_update will be set to the same if it
                            is not already ‘error_deleting’ or ‘error’.</paragraph>
                        <paragraph>If the status in model_update is ‘error_deleting’ or ‘error’, the
                            manager will raise an exception and the status of the group will be
                            set to ‘error’ in the db. If volumes_model_update is not returned by
                            the driver, the manager will set the status of every volume in the
                            group to ‘error’ in the except block.</paragraph>
                        <paragraph>If the driver raises an exception during the operation, it will be
                            caught by the try-except block in the manager. The statuses of the
                            group and all volumes in it will be set to ‘error’.</paragraph>
                        <paragraph>For a successful operation, the driver can either build the
                            model_update and volumes_model_update and return them or
                            return None, None. The statuses of the group and all volumes
                            will be set to ‘deleted’ after the manager deletes them from db.</paragraph>
                    </desc_content>
                </desc>
                <index entries="['single',\ 'update_consistencygroup()\ (VolumeConsistencyGroupDriver\ method)',\ 'cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.update_consistencygroup',\ '',\ None]"></index>
                <desc desctype="method" domain="py" noindex="False" objtype="method">
                    <desc_signature class="VolumeConsistencyGroupDriver" first="False" fullname="VolumeConsistencyGroupDriver.update_consistencygroup" ids="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.update_consistencygroup" module="cinder.interface.volume_consistencygroup_driver" names="cinder.interface.volume_consistencygroup_driver.VolumeConsistencyGroupDriver.update_consistencygroup"><desc_name xml:space="preserve">update_consistencygroup</desc_name><desc_parameterlist xml:space="preserve"><desc_parameter xml:space="preserve">context</desc_parameter><desc_parameter xml:space="preserve">group</desc_parameter><desc_parameter xml:space="preserve">add_volumes=None</desc_parameter><desc_parameter xml:space="preserve">remove_volumes=None</desc_parameter></desc_parameterlist></desc_signature>
                    <desc_content>
                        <paragraph>Updates a consistency group.</paragraph>
                        <field_list>
                            <field>
                                <field_name>Parameters</field_name>
                                <field_body>
                                    <bullet_list>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">context</literal_strong> – the context of the caller.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">group</literal_strong> – the dictionary of the consistency group to be updated.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">add_volumes</literal_strong> – a list of volume dictionaries to be added.</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal_strong refspecific="True">remove_volumes</literal_strong> – a list of volume dictionaries to be removed.</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </field_body>
                            </field>
                            <field>
                                <field_name>Returns</field_name>
                                <field_body>
                                    <paragraph>model_update, add_volumes_update, remove_volumes_update</paragraph>
                                </field_body>
                            </field>
                        </field_list>
                        <paragraph>model_update is a dictionary that the driver wants the manager
                            to update upon a successful return. If None is returned, the manager
                            will set the status to ‘available’.</paragraph>
                        <paragraph>add_volumes_update and remove_volumes_update are lists of dictionaries
                            that the driver wants the manager to update upon a successful return.
                            Note that each entry requires a {‘id’: xxx} so that the correct
                            volume entry can be updated. If None is returned, the volume will
                            remain its original status. Also note that you cannot directly
                            assign add_volumes to add_volumes_update as add_volumes is a list of
                            cinder.db.sqlalchemy.models.Volume objects and cannot be used for
                            db update directly. Same with remove_volumes.</paragraph>
                        <paragraph>If the driver throws an exception, the status of the group as well as
                            those of the volumes to be added/removed will be set to ‘error’.</paragraph>
                    </desc_content>
                </desc>
            </desc_content>
        </desc>
    </section>
</document>
