<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/admin/ts-failed-attach-vol-after-detach.rst">
    <section ids="failed-to-attach-volume-after-detaching" names="failed\ to\ attach\ volume\ after\ detaching">
        <title>Failed to attach volume after detaching</title>
        <section ids="problem" names="problem">
            <title>Problem</title>
            <paragraph>Failed to attach a volume after detaching the same volume.</paragraph>
        </section>
        <section ids="solution" names="solution">
            <title>Solution</title>
            <paragraph>You must change the device name on the <literal_strong classes="command">nova-attach</literal_strong> command. The VM
                might not clean up after a <literal_strong classes="command">nova-detach</literal_strong> command runs. This example
                shows how the <literal_strong classes="command">nova-attach</literal_strong> command fails when you use the <literal>vdb</literal>,
                <literal>vdc</literal>, or <literal>vdd</literal> device names:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># ls -al /dev/disk/by-path/
total 0
drwxr-xr-x 2 root root 200 2012-08-29 17:33 .
drwxr-xr-x 5 root root 100 2012-08-29 17:33 ..
lrwxrwxrwx 1 root root 9 2012-08-29 17:33 pci-0000:00:04.0-virtio-pci-virtio0 -&gt; ../../vda
lrwxrwxrwx 1 root root 10 2012-08-29 17:33 pci-0000:00:04.0-virtio-pci-virtio0-part1 -&gt; ../../vda1
lrwxrwxrwx 1 root root 10 2012-08-29 17:33 pci-0000:00:04.0-virtio-pci-virtio0-part2 -&gt; ../../vda2
lrwxrwxrwx 1 root root 10 2012-08-29 17:33 pci-0000:00:04.0-virtio-pci-virtio0-part5 -&gt; ../../vda5
lrwxrwxrwx 1 root root 9 2012-08-29 17:33 pci-0000:00:06.0-virtio-pci-virtio2 -&gt; ../../vdb
lrwxrwxrwx 1 root root 9 2012-08-29 17:33 pci-0000:00:08.0-virtio-pci-virtio3 -&gt; ../../vdc
lrwxrwxrwx 1 root root 9 2012-08-29 17:33 pci-0000:00:09.0-virtio-pci-virtio4 -&gt; ../../vdd
lrwxrwxrwx 1 root root 10 2012-08-29 17:33 pci-0000:00:09.0-virtio-pci-virtio4-part1 -&gt; ../../vdd1</literal_block>
            <paragraph>You might also have this problem after attaching and detaching the same
                volume from the same VM with the same mount point multiple times. In
                this case, restart the KVM host.</paragraph>
        </section>
    </section>
</document>
