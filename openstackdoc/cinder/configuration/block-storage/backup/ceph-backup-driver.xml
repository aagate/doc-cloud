<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/backup/ceph-backup-driver.rst">
    <section ids="ceph-backup-driver" names="ceph\ backup\ driver">
        <title>Ceph backup driver</title>
        <paragraph>The Ceph backup driver backs up volumes of any type to a Ceph back-end
            store. The driver can also detect whether the volume to be backed up is
            a Ceph RBD volume, and if so, it tries to perform incremental and
            differential backups.</paragraph>
        <paragraph>For source Ceph RBD volumes, you can perform backups within the same
            Ceph pool (not recommended). You can also perform backups between
            different Ceph pools and between different Ceph clusters.</paragraph>
        <paragraph>At the time of writing, differential backup support in Ceph/librbd was
            quite new. This driver attempts a differential backup in the first
            instance. If the differential backup fails, the driver falls back to
            full backup/copy.</paragraph>
        <paragraph>If incremental backups are used, multiple backups of the same volume are
            stored as snapshots so that minimal space is consumed in the backup
            store. It takes far less time to restore a volume than to take a full
            copy.</paragraph>
        <note>
            <paragraph>Block Storage enables you to:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Restore to a new volume, which is the default and recommended
                        action.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Restore to the original volume from which the backup was taken.
                        The restore action takes a full copy because this is the safest
                        action.</paragraph>
                </list_item>
            </bullet_list>
        </note>
        <paragraph>To enable the Ceph backup driver, include the following option in the
            <literal>cinder.conf</literal> file:</paragraph>
        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">backup_driver = cinder.backup.drivers.ceph</literal_block>
        <paragraph>The following configuration options are available for the Ceph backup
            driver.</paragraph>
        <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
        <target refid="cinder-backups-ceph"></target>
        <table classes="config-ref-table" ids="id1 cinder-backups-ceph" names="cinder-backups_ceph">
            <title>Description of Ceph backup driver configuration options</title>
            <tgroup cols="2">
                <colspec colwidth="50"></colspec>
                <colspec colwidth="50"></colspec>
                <thead>
                    <row>
                        <entry>
                            <paragraph>Configuration option = Default value</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Description</paragraph>
                        </entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>
                            <paragraph><strong>[DEFAULT]</strong></paragraph>
                        </entry>
                        <entry>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_chunk_size</literal> = <literal>134217728</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(Integer) The chunk size, in bytes, that a backup is broken into before transfer to the Ceph object store.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_conf</literal> = <literal>/etc/ceph/ceph.conf</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(String) Ceph configuration file to use.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_pool</literal> = <literal>backups</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(String) The Ceph pool where volume backups are stored.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_stripe_count</literal> = <literal>0</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(Integer) RBD stripe count to use when creating a backup image.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_stripe_unit</literal> = <literal>0</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(Integer) RBD stripe unit to use when creating a backup image.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>backup_ceph_user</literal> = <literal>cinder</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(String) The Ceph user to connect with. Default here is to use the same user as for Cinder volumes. If not using cephx this should be set to None.</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><literal>restore_discard_excess_bytes</literal> = <literal>True</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph>(Boolean) If True, always discard excess bytes when restoring volumes i.e. pad with zeroes.</paragraph>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <paragraph>This example shows the default options for the Ceph backup driver.</paragraph>
        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">backup_ceph_conf=/etc/ceph/ceph.conf
backup_ceph_user = cinder-backup
backup_ceph_chunk_size = 134217728
backup_ceph_pool = backups
backup_ceph_stripe_unit = 0
backup_ceph_stripe_count = 0</literal_block>
    </section>
</document>
