<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/vmware-vmdk-driver.rst">
    <target refid="block-storage-vmdk-driver"></target>
    <section ids="vmware-vmdk-driver block-storage-vmdk-driver" names="vmware\ vmdk\ driver block_storage_vmdk_driver">
        <title>VMware VMDK driver</title>
        <paragraph>Use the VMware VMDK driver to enable management of the OpenStack Block Storage
            volumes on vCenter-managed data stores. Volumes are backed by VMDK files on
            data stores that use any VMware-compatible storage technology such as NFS,
            iSCSI, FiberChannel, and vSAN.</paragraph>
        <note>
            <paragraph>The VMware VMDK driver requires vCenter version 5.1 at minimum.</paragraph>
        </note>
        <section ids="functional-context" names="functional\ context">
            <title>Functional context</title>
            <paragraph>The VMware VMDK driver connects to vCenter, through which it can dynamically
                access all the data stores visible from the ESX hosts in the managed cluster.</paragraph>
            <paragraph>When you create a volume, the VMDK driver creates a VMDK file on demand.  The
                VMDK file creation completes only when the volume is subsequently attached to
                an instance. The reason for this requirement is that data stores visible to the
                instance determine where to place the volume.  Before the service creates the
                VMDK file, attach a volume to the target instance.</paragraph>
            <paragraph>The running vSphere VM is automatically reconfigured to attach the VMDK file as
                an extra disk. Once attached, you can log in to the running vSphere VM to
                rescan and discover this extra disk.</paragraph>
            <paragraph>With the update to ESX version 6.0, the VMDK driver now supports NFS version
                4.1.</paragraph>
        </section>
        <section ids="configuration" names="configuration">
            <title>Configuration</title>
            <paragraph>The recommended volume driver for OpenStack Block Storage is the VMware vCenter
                VMDK driver. When you configure the driver, you must match it with the
                appropriate OpenStack Compute driver from VMware and both drivers must point to
                the same server.</paragraph>
            <paragraph>In the <literal>nova.conf</literal> file, use this option to define the Compute driver:</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">compute_driver = vmwareapi.VMwareVCDriver</literal_block>
            <paragraph>In the <literal>cinder.conf</literal> file, use this option to define the volume
                driver:</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.vmware.vmdk.VMwareVcVmdkDriver</literal_block>
            <paragraph>The following table lists various options that the drivers support for the
                OpenStack Block Storage configuration (<literal>cinder.conf</literal>):</paragraph>
            <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
            <target refid="cinder-vmware"></target>
            <table classes="config-ref-table" ids="id1 cinder-vmware" names="cinder-vmware">
                <title>Description of VMware configuration options</title>
                <tgroup cols="2">
                    <colspec colwidth="50"></colspec>
                    <colspec colwidth="50"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Configuration option = Default value</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Description</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><strong>[DEFAULT]</strong></paragraph>
                            </entry>
                            <entry>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_adapter_type</literal> = <literal>lsiLogic</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Default adapter type to be used for attaching volumes.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_api_retry_count</literal> = <literal>10</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Number of times VMware vCenter server API must be retried upon connection related issues.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_ca_file</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) CA bundle file to use in verifying the vCenter server certificate.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_cluster_name</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Multi-valued) Name of a vCenter compute cluster where volumes should be created.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_connection_pool_size</literal> = <literal>10</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Maximum number of connections in http connection pool.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_host_ip</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) IP address for connecting to VMware vCenter server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_host_password</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Password for authenticating with VMware vCenter server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_host_port</literal> = <literal>443</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Port number) Port number for connecting to VMware vCenter server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_host_username</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Username for authenticating with VMware vCenter server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_host_version</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Optional string specifying the VMware vCenter server version. The driver attempts to retrieve the version from VMware vCenter server. Set this configuration only if you want to override the vCenter server version.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_image_transfer_timeout_secs</literal> = <literal>7200</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Timeout in seconds for VMDK volume transfer between Cinder and Glance.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_insecure</literal> = <literal>False</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Boolean) If true, the vCenter server certificate is not verified. If false, then the default CA truststore is used for verification. This option is ignored if “vmware_ca_file” is set.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_max_objects_retrieval</literal> = <literal>100</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Max number of objects to be retrieved per batch. Query results will be obtained in batches from the server and not in one shot. Server may still limit the count to something less than the configured value.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_task_poll_interval</literal> = <literal>2.0</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Floating point) The interval (in seconds) for polling remote tasks invoked on VMware vCenter server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_tmp_dir</literal> = <literal>/tmp</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Directory where virtual disks are stored during volume backup and restore.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_volume_folder</literal> = <literal>Volumes</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Name of the vCenter inventory folder that will contain Cinder volumes. This folder will be created under “OpenStack/&lt;project_folder&gt;”, where project_folder is of format “Project (&lt;volume_project_id&gt;)”.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>vmware_wsdl_location</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Optional VIM service WSDL Location e.g <reference refuri="http:/">http:/</reference>/&lt;server&gt;/vimService.wsdl. Optional over-ride to default location for bug work-arounds.</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section ids="vmdk-disk-type" names="vmdk\ disk\ type">
            <title>VMDK disk type</title>
            <paragraph>The VMware VMDK drivers support the creation of VMDK disk file types <literal>thin</literal>,
                <literal>lazyZeroedThick</literal> (sometimes called thick or flat), or <literal>eagerZeroedThick</literal>.</paragraph>
            <paragraph>A thin virtual disk is allocated and zeroed on demand as the space is used.
                Unused space on a Thin disk is available to other users.</paragraph>
            <paragraph>A lazy zeroed thick virtual disk will have all space allocated at disk
                creation. This reserves the entire disk space, so it is not available to other
                users at any time.</paragraph>
            <paragraph>An eager zeroed thick virtual disk is similar to a lazy zeroed thick disk, in
                that the entire disk is allocated at creation. However, in this type, any
                previous data will be wiped clean on the disk before the write. This can mean
                that the disk will take longer to create, but can also prevent issues with
                stale data on physical media.</paragraph>
            <paragraph>Use the <literal>vmware:vmdk_type</literal> extra spec key with the appropriate value to
                specify the VMDK disk file type. This table shows the mapping between the extra
                spec entry and the VMDK disk file type:</paragraph>
            <table ids="id2">
                <title>Extra spec entry to VMDK disk file type mapping</title>
                <tgroup cols="3">
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Disk file type</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec key</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec value</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph>thin</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:vmdk_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>thin</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>lazyZeroedThick</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:vmdk_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>thick</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>eagerZeroedThick</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:vmdk_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>eagerZeroedThick</literal></paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <paragraph>If you do not specify a <literal>vmdk_type</literal> extra spec entry, the disk file type will
                default to <literal>thin</literal>.</paragraph>
            <paragraph>The following example shows how to create a <literal>lazyZeroedThick</literal> VMDK volume by
                using the appropriate <literal>vmdk_type</literal>:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume type create THICK_VOLUME
$ openstack volume type set --property vmware:vmdk_type=thick THICK_VOLUME
$ openstack volume create --size 1 --type THICK_VOLUME VOLUME1</literal_block>
        </section>
        <section ids="clone-type" names="clone\ type">
            <title>Clone type</title>
            <paragraph>With the VMware VMDK drivers, you can create a volume from another
                source volume or a snapshot point. The VMware vCenter VMDK driver
                supports the <literal>full</literal> and <literal>linked/fast</literal> clone types. Use the
                <literal>vmware:clone_type</literal> extra spec key to specify the clone type. The
                following table captures the mapping for clone types:</paragraph>
            <table ids="id3">
                <title>Extra spec entry to clone type mapping</title>
                <tgroup cols="3">
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Clone type</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec key</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec value</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph>full</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:clone_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>full</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>linked/fast</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:clone_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>linked</literal></paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <paragraph>If you do not specify the clone type, the default is <literal>full</literal>.</paragraph>
            <paragraph>The following example shows linked cloning from a source volume, which is
                created from an image:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume type create FAST_CLONE
$ openstack volume type set --property vmware:clone_type=linked FAST_CLONE
$ openstack volume create --size 1 --type FAST_CLONE --image MYIMAGE SOURCE_VOL
$ openstack volume create --size 1 --source SOURCE_VOL DEST_VOL</literal_block>
        </section>
        <section ids="adapter-type" names="adapter\ type">
            <title>Adapter type</title>
            <paragraph>The VMware vCenter VMDK driver supports the adapter types <literal>LSI Logic Parallel</literal>,
                <literal>BusLogic Parallel</literal>, <literal>LSI Logic SAS</literal>, <literal>VMware Paravirtual</literal> and <literal>IDE</literal> for
                volumes. Use the <literal>vmware:adapter_type</literal> extra spec key to specify the adapter
                type. The following table captures the mapping for adapter types:</paragraph>
            <table ids="id4">
                <title>Extra spec entry to adapter type mapping</title>
                <tgroup cols="3">
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <colspec colwidth="33"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Adapter type</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec key</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Extra spec value</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph>BusLogic Parallel</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:adapter_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>busLogic</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>IDE</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:adapter_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>ide</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>LSI Logic Parallel</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:adapter_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>lsiLogic</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>LSI Logic SAS</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:adapter_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>lsiLogicsas</literal></paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph>VMware Paravirtual</paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>vmware:adapter_type</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph><literal>paraVirtual</literal></paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <paragraph>If you do not specify the adapter type, the default is the value specified by
                the config option <literal>vmware_adapter_type</literal>.</paragraph>
        </section>
        <section ids="use-vcenter-storage-policies-to-specify-back-end-data-stores" names="use\ vcenter\ storage\ policies\ to\ specify\ back-end\ data\ stores">
            <title>Use vCenter storage policies to specify back-end data stores</title>
            <paragraph>This section describes how to configure back-end data stores using storage
                policies. In vCenter 5.5 and greater, you can create one or more storage
                policies and expose them as a Block Storage volume-type to a vmdk volume. The
                storage policies are exposed to the vmdk driver through the extra spec property
                with the <literal>vmware:storage_profile</literal> key.</paragraph>
            <paragraph>For example, assume a storage policy in vCenter named <literal>gold_policy.</literal> and a
                Block Storage volume type named <literal>vol1</literal> with the extra spec key
                <literal>vmware:storage_profile</literal> set to the value <literal>gold_policy</literal>. Any Block Storage
                volume creation that uses the <literal>vol1</literal> volume type places the volume only in
                data stores that match the <literal>gold_policy</literal> storage policy.</paragraph>
            <paragraph>The Block Storage back-end configuration for vSphere data stores is
                automatically determined based on the vCenter configuration. If you configure a
                connection to connect to vCenter version 5.5 or later in the <literal>cinder.conf</literal>
                file, the use of storage policies to configure back-end data stores is
                automatically supported.</paragraph>
            <note>
                <paragraph>You must configure any data stores that you configure for the Block
                    Storage service for the Compute service.</paragraph>
            </note>
            <paragraph><strong>To configure back-end data stores by using storage policies</strong></paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>In vCenter, tag the data stores to be used for the back end.</paragraph>
                    <paragraph>OpenStack also supports policies that are created by using vendor-specific
                        capabilities; for example vSAN-specific storage policies.</paragraph>
                    <note>
                        <paragraph>The tag value serves as the policy. For details, see <reference internal="True" refid="vmware-spbm"><inline classes="std std-ref">Storage policy-based configuration in vCenter</inline></reference>.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Set the extra spec key <literal>vmware:storage_profile</literal> in the desired Block
                        Storage volume types to the policy name that you created in the previous
                        step.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Optionally, for the <literal>vmware_host_version</literal> parameter, enter the version
                        number of your vSphere platform. For example, <literal>5.5</literal>.</paragraph>
                    <paragraph>This setting overrides the default location for the corresponding WSDL file.
                        Among other scenarios, you can use this setting to prevent WSDL error
                        messages during the development phase or to work with a newer version of
                        vCenter.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Complete the other vCenter configuration parameters as appropriate.</paragraph>
                </list_item>
            </enumerated_list>
            <note>
                <paragraph>Any volume that is created without an associated policy (that is to say,
                    without an associated volume type that specifies <literal>vmware:storage_profile</literal>
                    extra spec), there is no policy-based placement for that volume.</paragraph>
            </note>
        </section>
        <section ids="supported-operations" names="supported\ operations">
            <title>Supported operations</title>
            <paragraph>The VMware vCenter VMDK driver supports these operations:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Create, delete, attach, and detach volumes.</paragraph>
                    <note>
                        <paragraph>When a volume is attached to an instance, a reconfigure operation is
                            performed on the instance to add the volume’s VMDK to it. The user must
                            manually rescan and mount the device from within the guest operating
                            system.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Create, list, and delete volume snapshots.</paragraph>
                    <note>
                        <paragraph>Allowed only if volume is not attached to an instance.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Create a volume from a snapshot.</paragraph>
                    <note>
                        <paragraph>The vmdk UUID in vCenter will not be set to the volume UUID if the
                            vCenter version is 6.0 or above and the extra spec key <literal>vmware:clone_type</literal>
                            in the destination volume type is set to <literal>linked</literal>.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Copy an image to a volume.</paragraph>
                    <note>
                        <paragraph>Only images in <literal>vmdk</literal> disk format with <literal>bare</literal> container format are
                            supported. The <literal>vmware_disktype</literal> property of the image can be
                            <literal>preallocated</literal>, <literal>sparse</literal>, <literal>streamOptimized</literal> or <literal>thin</literal>.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Copy a volume to an image.</paragraph>
                    <note>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>Allowed only if the volume is not attached to an instance.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>This operation creates a <literal>streamOptimized</literal> disk image.</paragraph>
                            </list_item>
                        </bullet_list>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Clone a volume.</paragraph>
                    <note>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>Supported only if the source volume is not attached to an instance.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>The vmdk UUID in vCenter will not be set to the volume UUID if the
                                    vCenter version is 6.0 or above and the extra spec key <literal>vmware:clone_type</literal>
                                    in the destination volume type is set to <literal>linked</literal>.</paragraph>
                            </list_item>
                        </bullet_list>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Backup a volume.</paragraph>
                    <note>
                        <paragraph>This operation creates a backup of the volume in <literal>streamOptimized</literal>
                            disk format.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Restore backup to new or existing volume.</paragraph>
                    <note>
                        <paragraph>Supported only if the existing volume doesn’t contain snapshots.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Change the type of a volume.</paragraph>
                    <note>
                        <paragraph>This operation is supported only if the volume state is <literal>available</literal>.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Extend a volume.</paragraph>
                </list_item>
            </bullet_list>
            <target refid="vmware-spbm"></target>
        </section>
        <section ids="storage-policy-based-configuration-in-vcenter vmware-spbm" names="storage\ policy-based\ configuration\ in\ vcenter vmware-spbm">
            <title>Storage policy-based configuration in vCenter</title>
            <paragraph>You can configure Storage Policy-Based Management (SPBM) profiles for vCenter
                data stores supporting the Compute, Image service, and Block Storage components
                of an OpenStack implementation.</paragraph>
            <paragraph>In a vSphere OpenStack deployment, SPBM enables you to delegate several data
                stores for storage, which reduces the risk of running out of storage space. The
                policy logic selects the data store based on accessibility and available
                storage space.</paragraph>
        </section>
        <section ids="prerequisites" names="prerequisites">
            <title>Prerequisites</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Determine the data stores to be used by the SPBM policy.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Determine the tag that identifies the data stores in the OpenStack component
                        configuration.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create separate policies or sets of data stores for separate
                        OpenStack components.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="create-storage-policies-in-vcenter" names="create\ storage\ policies\ in\ vcenter">
            <title>Create storage policies in vCenter</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>In vCenter, create the tag that identifies the data stores:</paragraph>
                    <enumerated_list enumtype="arabic" prefix="" suffix=".">
                        <list_item>
                            <paragraph>From the <inline classes="guilabel" rawtext=":guilabel:`Home`">Home</inline> screen, click <inline classes="guilabel" rawtext=":guilabel:`Tags`">Tags</inline>.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Specify a name for the tag.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Specify a tag category. For example, <literal>spbm-cinder</literal>.</paragraph>
                        </list_item>
                    </enumerated_list>
                </list_item>
                <list_item>
                    <paragraph>Apply the tag to the data stores to be used by the SPBM policy.</paragraph>
                    <note>
                        <paragraph>For details about creating tags in vSphere, see the <reference name="vSphere documentation" refuri="http://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.vsphere.vcenterhost.doc/GUID-379F40D3-8CD6-449E-89CB-79C4E2683221.html">vSphere
                                documentation</reference>.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>In vCenter, create a tag-based storage policy that uses one or more tags to
                        identify a set of data stores.</paragraph>
                    <note>
                        <paragraph>For details about creating storage policies in vSphere, see the <reference name="vSphere documentation" refuri="http://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.vsphere.storage.doc/GUID-89091D59-D844-46B2-94C2-35A3961D23E7.html">vSphere
                                documentation</reference>.</paragraph>
                    </note>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="data-store-selection" names="data\ store\ selection">
            <title>Data store selection</title>
            <paragraph>If storage policy is enabled, the driver initially selects all the data stores
                that match the associated storage policy.</paragraph>
            <paragraph>If two or more data stores match the storage policy, the driver chooses a data
                store that is connected to the maximum number of hosts.</paragraph>
            <paragraph>In case of ties, the driver chooses the data store with lowest space
                utilization, where space utilization is defined by the
                <literal>(1-freespace/totalspace)</literal> meters.</paragraph>
            <paragraph>These actions reduce the number of volume migrations while attaching the volume
                to instances.</paragraph>
            <paragraph>The volume must be migrated if the ESX host for the instance cannot access the
                data store that contains the volume.</paragraph>
        </section>
    </section>
</document>
