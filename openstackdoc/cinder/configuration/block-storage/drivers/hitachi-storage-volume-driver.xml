<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/hitachi-storage-volume-driver.rst">
    <section ids="hitachi-storage-volume-driver" names="hitachi\ storage\ volume\ driver">
        <title>Hitachi storage volume driver</title>
        <paragraph>Hitachi storage volume driver provides iSCSI and Fibre Channel
            support for Hitachi storages.</paragraph>
        <section ids="system-requirements" names="system\ requirements">
            <title>System requirements</title>
            <paragraph>Supported storages:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Hitachi Virtual Storage Platform G1000 (VSP G1000)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Hitachi Virtual Storage Platform (VSP)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Hitachi Unified Storage VM (HUS VM)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Hitachi Unified Storage 100 Family (HUS 100 Family)</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Required software:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>RAID Manager Ver 01-32-03/01 or later for VSP G1000/VSP/HUS VM</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Hitachi Storage Navigator Modular 2 (HSNM2) Ver 27.50 or later
                        for HUS 100 Family</paragraph>
                    <note>
                        <paragraph>HSNM2 needs to be installed under <literal>/usr/stonavm</literal>.</paragraph>
                    </note>
                </list_item>
            </bullet_list>
            <paragraph>Required licenses:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Hitachi In-System Replication Software for VSP G1000/VSP/HUS VM</paragraph>
                </list_item>
                <list_item>
                    <paragraph>(Mandatory) ShadowImage in-system replication for HUS 100 Family</paragraph>
                </list_item>
                <list_item>
                    <paragraph>(Optional) Copy-on-Write Snapshot for HUS 100 Family</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Additionally, the <literal>pexpect</literal> package is required.</paragraph>
        </section>
        <section ids="supported-operations" names="supported\ operations">
            <title>Supported operations</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Create, delete, attach, and detach volumes.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create, list, and delete volume snapshots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Manage and unmanage volume snapshots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a volume from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy a volume to an image.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy an image to a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Clone a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Get volume statistics.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="configuration" names="configuration">
            <title>Configuration</title>
            <section ids="set-up-hitachi-storage" names="set\ up\ hitachi\ storage">
                <title>Set up Hitachi storage</title>
                <paragraph>You need to specify settings as described below. For details about each step,
                    see the user’s guide of the storage device. Use a storage administrative
                    software such as <literal>Storage Navigator</literal> to set up the storage device so that
                    LDEVs and host groups can be created and deleted, and LDEVs can be connected
                    to the server and can be asynchronously copied.</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Create a Dynamic Provisioning pool.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Connect the ports at the storage to the controller node and compute nodes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>For VSP G1000/VSP/HUS VM, set <literal>port security</literal> to <literal>enable</literal> for the
                            ports at the storage.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>For HUS 100 Family, set <literal>Host Group security</literal> or
                            <literal>iSCSI target security</literal> to <literal>ON</literal> for the ports at the storage.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>For the ports at the storage, create host groups (iSCSI targets) whose
                            names begin with HBSD- for the controller node and each compute node.
                            Then register a WWN (initiator IQN) for each of the controller node and
                            compute nodes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>For VSP G1000/VSP/HUS VM, perform the following:</paragraph>
                        <bullet_list bullet="*">
                            <list_item>
                                <paragraph>Create a storage device account belonging to the Administrator User
                                    Group. (To use multiple storage devices, create the same account name
                                    for all the target storage devices, and specify the same resource
                                    group and permissions.)</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>Create a command device (In-Band), and set user authentication to <literal>ON</literal>.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>Register the created command device to the host group for the controller
                                    node.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>To use the Thin Image function, create a pool for Thin Image.</paragraph>
                            </list_item>
                        </bullet_list>
                    </list_item>
                    <list_item>
                        <paragraph>For HUS 100 Family, perform the following:</paragraph>
                        <bullet_list bullet="*">
                            <list_item>
                                <paragraph>Use the <literal_strong classes="command">auunitaddauto</literal_strong> command to register the
                                    unit name and controller of the storage device to HSNM2.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>When connecting via iSCSI, if you are using CHAP certification, specify
                                    the same user and password as that used for the storage port.</paragraph>
                            </list_item>
                        </bullet_list>
                    </list_item>
                </enumerated_list>
            </section>
            <section ids="set-up-hitachi-gigabit-fibre-channel-adaptor" names="set\ up\ hitachi\ gigabit\ fibre\ channel\ adaptor">
                <title>Set up Hitachi Gigabit Fibre Channel adaptor</title>
                <paragraph>Change a parameter of the hfcldd driver and update the <literal>initram</literal> file
                    if Hitachi Gigabit Fibre Channel adaptor is used:</paragraph>
                <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># /opt/hitachi/drivers/hba/hfcmgr -E hfc_rport_lu_scan 1
# dracut -f initramfs-KERNEL_VERSION.img KERNEL_VERSION
# reboot</literal_block>
            </section>
            <section ids="set-up-hitachi-storage-volume-driver" names="set\ up\ hitachi\ storage\ volume\ driver">
                <title>Set up Hitachi storage volume driver</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Create a directory:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># mkdir /var/lock/hbsd
# chown cinder:cinder /var/lock/hbsd</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Create <literal>volume type</literal> and <literal>volume key</literal>.</paragraph>
                        <paragraph>This example shows that HUS100_SAMPLE is created as <literal>volume type</literal>
                            and hus100_backend is registered as <literal>volume key</literal>:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume type create HUS100_SAMPLE
$ openstack volume type set --property volume_backend_name=hus100_backend HUS100_SAMPLE</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Specify any identical <literal>volume type</literal> name and <literal>volume key</literal>.</paragraph>
                        <paragraph>To confirm the created <literal>volume type</literal>, please execute the following
                            command:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume type list --long</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Edit the <literal>/etc/cinder/cinder.conf</literal> file as follows.</paragraph>
                        <paragraph>If you use Fibre Channel:</paragraph>
                        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.hitachi.hbsd_fc.HBSDFCDriver</literal_block>
                        <paragraph>If you use iSCSI:</paragraph>
                        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.hitachi.hbsd_iscsi.HBSDISCSIDriver</literal_block>
                        <paragraph>Also, set <literal>volume_backend_name</literal> created by <literal_strong classes="command">openstack volume type set</literal_strong>
                            command:</paragraph>
                        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_backend_name = hus100_backend</literal_block>
                        <paragraph>This table shows configuration options for Hitachi storage volume driver.</paragraph>
                        <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
                        <target refid="cinder-hitachi-hbsd"></target>
                        <table classes="config-ref-table" ids="id1 cinder-hitachi-hbsd" names="cinder-hitachi-hbsd">
                            <title>Description of Hitachi storage volume driver configuration options</title>
                            <tgroup cols="2">
                                <colspec colwidth="50"></colspec>
                                <colspec colwidth="50"></colspec>
                                <thead>
                                    <row>
                                        <entry>
                                            <paragraph>Configuration option = Default value</paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>Description</paragraph>
                                        </entry>
                                    </row>
                                </thead>
                                <tbody>
                                    <row>
                                        <entry>
                                            <paragraph><strong>[DEFAULT]</strong></paragraph>
                                        </entry>
                                        <entry>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_add_chap_user</literal> = <literal>False</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Boolean) Add CHAP user</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_async_copy_check_interval</literal> = <literal>10</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Interval to check copy asynchronously</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_auth_method</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) iSCSI authentication method</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_auth_password</literal> = <literal>HBSD-CHAP-password</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) iSCSI authentication password</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_auth_user</literal> = <literal>HBSD-CHAP-user</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) iSCSI authentication username</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_copy_check_interval</literal> = <literal>3</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Interval to check copy</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_copy_speed</literal> = <literal>3</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Copy speed of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_default_copy_method</literal> = <literal>FULL</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Default copy method of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_group_range</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Range of group number</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_group_request</literal> = <literal>False</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Boolean) Request for creating HostGroup or iSCSI Target</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_horcm_add_conf</literal> = <literal>True</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Boolean) Add to HORCM configuration</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_horcm_numbers</literal> = <literal>200,201</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Instance numbers for HORCM</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_horcm_password</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Password of storage system for HORCM</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_horcm_resource_lock_timeout</literal> = <literal>600</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Timeout until a resource lock is released, in seconds. The value must be between 0 and 7200.</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_horcm_user</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Username of storage system for HORCM</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_ldev_range</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Range of logical device of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_pool_id</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Pool ID of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_serial_number</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Serial number of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_target_ports</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Control port names for HostGroup or iSCSI Target</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_thin_pool_id</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Integer) Thin pool ID of storage system</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_unit_name</literal> = <literal>None</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(String) Name of an array unit</paragraph>
                                        </entry>
                                    </row>
                                    <row>
                                        <entry>
                                            <paragraph><literal>hitachi_zoning_request</literal> = <literal>False</literal></paragraph>
                                        </entry>
                                        <entry>
                                            <paragraph>(Boolean) Request for FC Zone creating HostGroup</paragraph>
                                        </entry>
                                    </row>
                                </tbody>
                            </tgroup>
                        </table>
                    </list_item>
                    <list_item>
                        <paragraph>Restart the Block Storage service.</paragraph>
                        <paragraph>When the startup is done, “MSGID0003-I: The storage backend can be used.”
                            is output into <literal>/var/log/cinder/volume.log</literal> as follows:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">2014-09-01 10:34:14.169 28734 WARNING cinder.volume.drivers.hitachi.
hbsd_common [req-a0bb70b5-7c3f-422a-a29e-6a55d6508135 None None]
MSGID0003-I: The storage backend can be used. (config_group: hus100_backend)</literal_block>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
    </section>
</document>
