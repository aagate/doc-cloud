<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/nexentastor5-driver.rst">
    <section ids="nexentastor-5-x-nfs-and-iscsi-drivers" names="nexentastor\ 5.x\ nfs\ and\ iscsi\ drivers">
        <title>NexentaStor 5.x NFS and iSCSI drivers</title>
        <paragraph>NexentaStor is an Open Source-driven Software-Defined Storage (OpenSDS)
            platform delivering unified file (NFS and SMB) and block (FC and iSCSI)
            storage services. NexentaStor runs on industry standard hardware, scales from
            tens of terabytes to petabyte configurations, and includes all data management
            functionality by default.</paragraph>
        <paragraph>For user documentation, see the
            <reference name="Nexenta Documentation Center" refuri="https://nexenta.com/products/documentation">Nexenta Documentation Center</reference>.</paragraph>
        <section ids="supported-operations" names="supported\ operations">
            <title>Supported operations</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Create, delete, attach, and detach volumes.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create, list, and delete volume snapshots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a volume from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy an image to a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy a volume to an image.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Clone a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Migrate a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Change volume type.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="iscsi-driver" names="iscsi\ driver">
            <title>iSCSI driver</title>
            <paragraph>The NexentaStor appliance must be installed and configured according to the
                relevant Nexenta documentation. A pool and an enclosing namespace must be
                created for all iSCSI volumes to be accessed through the volume driver. This
                should be done as specified in the release-specific NexentaStor documentation.</paragraph>
            <paragraph>The NexentaStor Appliance iSCSI driver is selected using the normal procedures
                for one or multiple back-end volume drivers.</paragraph>
            <paragraph>You must configure these items for each NexentaStor appliance that the iSCSI
                volume driver controls:</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Make the following changes on the volume node <literal>/etc/cinder/cinder.conf</literal>
                        file.</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># Enable Nexenta iSCSI driver
volume_driver=cinder.volume.drivers.nexenta.ns5.iscsi.NexentaISCSIDriver

# IP address of NexentaStor host (string value)
nexenta_host=HOST-IP

# Port for Rest API (integer value)
nexenta_rest_port=8080

# Username for NexentaStor Rest (string value)
nexenta_user=USERNAME

# Password for NexentaStor Rest (string value)
nexenta_password=PASSWORD

# Pool on NexentaStor appliance (string value)
nexenta_volume=volume_name

# Name of a parent Volume group where cinder created zvols will reside (string value)
nexenta_volume_group = iscsi</literal_block>
                    <note>
                        <paragraph>nexenta_volume represents a zpool, which is called pool on NS 5.x appliance.
                            It must be pre-created before enabling the driver.</paragraph>
                        <paragraph>Volume group does not need to be pre-created, the driver will create it if does not exist.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Save the changes to the <literal>/etc/cinder/cinder.conf</literal> file and
                        restart the <literal>cinder-volume</literal> service.</paragraph>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="nfs-driver" names="nfs\ driver">
            <title>NFS driver</title>
            <paragraph>The Nexenta NFS driver allows you to use NexentaStor appliance to store
                Compute volumes via NFS. Every Compute volume is represented by a single
                NFS file within a shared directory.</paragraph>
            <paragraph>While the NFS protocols standardize file access for users, they do not
                standardize administrative actions such as taking snapshots or replicating
                file systems. The OpenStack Volume Drivers bring a common interface to these
                operations. The Nexenta NFS driver implements these standard actions using the
                ZFS management plane that already is deployed on NexentaStor appliances.</paragraph>
            <paragraph>The NexentaStor appliance must be installed and configured according to the
                relevant Nexenta documentation. A single-parent file system must be created
                for all virtual disk directories supported for OpenStack.
                Create and export the directory on each NexentaStor appliance.</paragraph>
            <paragraph>You must configure these items for each NexentaStor appliance that the NFS
                volume driver controls:</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Make the following changes on the volume node <literal>/etc/cinder/cinder.conf</literal>
                        file.</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># Enable Nexenta NFS driver
volume_driver=cinder.volume.drivers.nexenta.ns5.nfs.NexentaNfsDriver

# IP address or Hostname of NexentaStor host (string value)
nas_host=HOST-IP

# Port for Rest API (integer value)
nexenta_rest_port=8080

# Path to parent filesystem (string value)
nas_share_path=POOL/FILESYSTEM

# Specify NFS version
nas_mount_options=vers=4</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Create filesystem on appliance and share via NFS. For example:</paragraph>
                    <literal_block highlight_args="{}" language="vim" linenos="False" xml:space="preserve">"securityContexts": [
   {"readWriteList": [{"allow": true, "etype": "fqnip", "entity": "1.1.1.1"}],
    "root": [{"allow": true, "etype": "fqnip", "entity": "1.1.1.1"}],
    "securityModes": ["sys"]}]</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Create ACL for the filesystem. For example:</paragraph>
                    <literal_block highlight_args="{}" language="json" linenos="False" xml:space="preserve">{"type": "allow",
"principal": "everyone@",
"permissions": ["list_directory","read_data","add_file","write_data",
"add_subdirectory","append_data","read_xattr","write_xattr","execute",
"delete_child","read_attributes","write_attributes","delete","read_acl",
"write_acl","write_owner","synchronize"],
"flags": ["file_inherit","dir_inherit"]}</literal_block>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="driver-options" names="driver\ options">
            <title>Driver options</title>
            <paragraph>Nexenta Driver supports these options:</paragraph>
            <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
            <target refid="cinder-nexenta5"></target>
            <table classes="config-ref-table" ids="id1 cinder-nexenta5" names="cinder-nexenta5">
                <title>Description of NexentaStor 5 driver configuration options</title>
                <tgroup cols="2">
                    <colspec colwidth="50"></colspec>
                    <colspec colwidth="50"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Configuration option = Default value</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Description</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><strong>[DEFAULT]</strong></paragraph>
                            </entry>
                            <entry>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_dataset_compression</literal> = <literal>on</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Compression value for new ZFS folders.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_dataset_dedup</literal> = <literal>off</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Deduplication value for new ZFS folders.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_dataset_description</literal> =</paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Human-readable description for the folder.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_host</literal> =</paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) IP address of Nexenta SA</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_iscsi_target_portal_port</literal> = <literal>3260</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Nexenta target portal port</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_mount_point_base</literal> = <literal>$state_path/mnt</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Base directory that contains NFS share mount points</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_ns5_blocksize</literal> = <literal>32</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Block size for datasets</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_rest_port</literal> = <literal>0</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) HTTP(S) port to connect to Nexenta REST API server. If it is equal zero, 8443 for HTTPS and 8080 for HTTP is used</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_rest_protocol</literal> = <literal>auto</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Use http or https for REST connection (default auto)</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_sparse</literal> = <literal>False</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Boolean) Enables or disables the creation of sparse datasets</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_sparsed_volumes</literal> = <literal>True</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Boolean) Enables or disables the creation of volumes as sparsed files that take no space. If disabled (False), volume is created as a regular file, which takes a long time.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_use_https</literal> = <literal>True</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Boolean) Use secure HTTP for REST connection (default True)</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_user</literal> = <literal>admin</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) User name to connect to Nexenta SA</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_volume</literal> = <literal>cinder</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) SA Pool that holds all volumes</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>nexenta_volume_group</literal> = <literal>iscsi</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Volume group for ns5</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
    </section>
</document>
