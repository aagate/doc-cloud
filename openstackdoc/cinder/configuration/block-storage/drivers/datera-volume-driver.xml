<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/datera-volume-driver.rst">
    <section ids="datera-drivers" names="datera\ drivers">
        <title>Datera drivers</title>
        <section ids="datera-iscsi-driver" names="datera\ iscsi\ driver">
            <title>Datera iSCSI driver</title>
            <paragraph>The Datera Elastic Data Fabric (EDF) is a scale-out storage software that
                turns standard, commodity hardware into a RESTful API-driven, intent-based
                policy controlled storage fabric for large-scale clouds. The Datera EDF
                integrates seamlessly with the Block Storage service. It provides storage
                through the iSCSI block protocol framework over the iSCSI block protocol.
                Datera supports all of the Block Storage services.</paragraph>
        </section>
        <section ids="system-requirements-prerequisites-and-recommendations" names="system\ requirements,\ prerequisites,\ and\ recommendations">
            <title>System requirements, prerequisites, and recommendations</title>
            <section ids="prerequisites" names="prerequisites">
                <title>Prerequisites</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Must be running compatible versions of OpenStack and Datera EDF.
                            Please visit <reference name="here" refuri="https://github.com/Datera/cinder">here</reference><target ids="here" names="here" refuri="https://github.com/Datera/cinder"></target> to determine the
                            correct version.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>All nodes must have access to Datera EDF through the iSCSI block protocol.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>All nodes accessing the Datera EDF must have the following packages
                            installed:</paragraph>
                        <bullet_list bullet="*">
                            <list_item>
                                <paragraph>Linux I/O (LIO)</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>open-iscsi</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>open-iscsi-utils</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>wget</paragraph>
                            </list_item>
                        </bullet_list>
                    </list_item>
                </bullet_list>
                <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
                <target refid="cinder-datera"></target>
                <table classes="config-ref-table" ids="id1 cinder-datera" names="cinder-datera">
                    <title>Description of Datera volume driver configuration options</title>
                    <tgroup cols="2">
                        <colspec colwidth="50"></colspec>
                        <colspec colwidth="50"></colspec>
                        <thead>
                            <row>
                                <entry>
                                    <paragraph>Configuration option = Default value</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Description</paragraph>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph><strong>[DEFAULT]</strong></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_503_interval</literal> = <literal>5</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Integer) Interval between 503 retries</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_503_timeout</literal> = <literal>120</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Integer) Timeout for HTTP 503 retry messages</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_api_port</literal> = <literal>7717</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) Datera API port.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_api_version</literal> = <literal>2</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) DEPRECATED: Datera API version.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_debug</literal> = <literal>False</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Boolean) True to set function arg and return logging</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_debug_replica_count_override</literal> = <literal>False</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Boolean) ONLY FOR DEBUG/TESTING PURPOSES True to set replica_count to 1</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>datera_tenant_id</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) If set to ‘Map’ –&gt; OpenStack project ID will be mapped implicitly to Datera tenant ID If set to ‘None’ –&gt; Datera tenant ID will not be used during volume provisioning If set to anything else –&gt; Datera tenant ID will be the provided value</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </section>
            <section ids="configuring-the-datera-volume-driver" names="configuring\ the\ datera\ volume\ driver">
                <title>Configuring the Datera volume driver</title>
                <paragraph>Modify the <literal>/etc/cinder/cinder.conf</literal> file for Block Storage service.</paragraph>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Enable the Datera volume driver:</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
# ...
enabled_backends = datera
# ...</literal_block>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Optional. Designate Datera as the default back-end:</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">default_volume_type = datera</literal_block>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Create a new section for the Datera back-end definition. The <literal>san_ip</literal> can
                            be either the Datera Management Network VIP or one of the Datera iSCSI
                            Access Network VIPs depending on the network segregation requirements:</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.datera.DateraDriver
san_ip = &lt;IP_ADDR&gt;            # The OOB Management IP of the cluster
san_login = admin             # Your cluster admin login
san_password = password       # Your cluster admin password
san_is_local = true
datera_num_replicas = 3       # Number of replicas to use for volume</literal_block>
            </section>
            <section ids="enable-the-datera-volume-driver" names="enable\ the\ datera\ volume\ driver">
                <title>Enable the Datera volume driver</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Verify the OpenStack control node can reach the Datera <literal>san_ip</literal>:</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="bash" linenos="False" xml:space="preserve">$ ping -c 4 &lt;san_IP&gt;</literal_block>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Start the Block Storage service on all nodes running the <literal>cinder-volume</literal>
                            services:</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="bash" linenos="False" xml:space="preserve">$ service cinder-volume restart</literal_block>
                <paragraph>QoS support for the Datera drivers includes the ability to set the
                    following capabilities in QoS Specs</paragraph>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph><strong>read_iops_max</strong> – must be positive integer</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>write_iops_max</strong> – must be positive integer</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>total_iops_max</strong> – must be positive integer</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>read_bandwidth_max</strong> – in KB per second, must be positive integer</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>write_bandwidth_max</strong> – in KB per second, must be positive integer</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><strong>total_bandwidth_max</strong> – in KB per second, must be positive integer</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="bash" linenos="False" xml:space="preserve"># Create qos spec
$ openstack volume qos create --property total_iops_max=1000 total_bandwidth_max=2000 DateraBronze

# Associate qos-spec with volume type
$ openstack volume qos associate DateraBronze VOLUME_TYPE

# Add additional qos values or update existing ones
$ openstack volume qos set --property read_bandwidth_max=500 DateraBronze</literal_block>
            </section>
            <section ids="supported-operations" names="supported\ operations">
                <title>Supported operations</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Create, delete, attach, detach, manage, unmanage, and list volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create, list, and delete volume snapshots.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a volume from a snapshot.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Copy an image to a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Copy a volume to an image.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Clone a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Extend a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Support for naming convention changes.</paragraph>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="configuring-multipathing" names="configuring\ multipathing">
                <title>Configuring multipathing</title>
                <paragraph>The following configuration is for 3.X Linux kernels, some parameters in
                    different Linux distributions may be different. Make the following changes
                    in the <literal>multipath.conf</literal> file:</paragraph>
                <literal_block highlight_args="{}" language="text" linenos="False" xml:space="preserve">defaults {
checker_timer 5
}
devices {
    device {
        vendor "DATERA"
        product "IBLOCK"
        getuid_callout "/lib/udev/scsi_id --whitelisted –
        replace-whitespace --page=0x80 --device=/dev/%n"
        path_grouping_policy group_by_prio
        path_checker tur
        prio alua
        path_selector "queue-length 0"
        hardware_handler "1 alua"
        failback 5
    }
}
blacklist {
    device {
        vendor ".*"
        product ".*"
    }
}
blacklist_exceptions {
    device {
        vendor "DATERA.*"
        product "IBLOCK.*"
    }
}</literal_block>
            </section>
        </section>
    </section>
</document>
