<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/fujitsu-eternus-dx-driver.rst">
    <section ids="fujitsu-eternus-dx-driver" names="fujitsu\ eternus\ dx\ driver">
        <title>Fujitsu ETERNUS DX driver</title>
        <paragraph>Fujitsu ETERNUS DX driver provides FC and iSCSI support for
            ETERNUS DX S3 series.</paragraph>
        <paragraph>The driver performs volume operations by communicating with
            ETERNUS DX. It uses a CIM client in Python called PyWBEM
            to perform CIM operations over HTTP.</paragraph>
        <paragraph>You can specify RAID Group and Thin Provisioning Pool (TPP)
            in ETERNUS DX as a storage pool.</paragraph>
        <section ids="system-requirements" names="system\ requirements">
            <title>System requirements</title>
            <paragraph>Supported storages:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>ETERNUS DX60 S3</paragraph>
                </list_item>
                <list_item>
                    <paragraph>ETERNUS DX100 S3/DX200 S3</paragraph>
                </list_item>
                <list_item>
                    <paragraph>ETERNUS DX500 S3/DX600 S3</paragraph>
                </list_item>
                <list_item>
                    <paragraph>ETERNUS DX8700 S3/DX8900 S3</paragraph>
                </list_item>
                <list_item>
                    <paragraph>ETERNUS DX200F</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Requirements:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Firmware version V10L30 or later is required.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>The multipath environment with ETERNUS Multipath Driver is unsupported.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>An Advanced Copy Feature license is required
                        to create a snapshot and a clone.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="supported-operations" names="supported\ operations">
            <title>Supported operations</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Create, delete, attach, and detach volumes.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create, list, and delete volume snapshots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a volume from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy an image to a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Copy a volume to an image.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Clone a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a volume. (*1)</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Get volume statistics.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>(*1): It is executable only when you use TPP as a storage pool.</paragraph>
        </section>
        <section ids="preparation" names="preparation">
            <title>Preparation</title>
            <section ids="package-installation" names="package\ installation">
                <title>Package installation</title>
                <paragraph>Install the <literal>python-pywbem</literal> package for your distribution.</paragraph>
            </section>
            <section ids="eternus-dx-setup" names="eternus\ dx\ setup">
                <title>ETERNUS DX setup</title>
                <paragraph>Perform the following steps using ETERNUS Web GUI or ETERNUS CLI.</paragraph>
                <note>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>These following operations require an account that has the <literal>Admin</literal> role.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>For detailed operations, refer to ETERNUS Web GUI User’s Guide or
                                ETERNUS CLI User’s Guide for ETERNUS DX S3 series.</paragraph>
                        </list_item>
                    </bullet_list>
                </note>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Create an account for communication with cinder controller.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Enable the SMI-S of ETERNUS DX.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Register an Advanced Copy Feature license and configure copy table size.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a storage pool for volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>(Optional) If you want to create snapshots
                            on a different storage pool for volumes,
                            create a storage pool for snapshots.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create Snap Data Pool Volume (SDPV) to enable Snap Data Pool (SDP) for
                            <literal>create a snapshot</literal>.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Configure storage ports used for OpenStack.</paragraph>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>Set those storage ports to CA mode.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>Enable the host-affinity settings of those storage ports.</paragraph>
                                <paragraph>(ETERNUS CLI command for enabling host-affinity settings):</paragraph>
                                <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">CLI&gt; set fc-parameters -host-affinity enable -port &lt;CM#&gt;&lt;CA#&gt;&lt;Port#&gt;
CLI&gt; set iscsi-parameters -host-affinity enable -port &lt;CM#&gt;&lt;CA#&gt;&lt;Port#&gt;</literal_block>
                            </list_item>
                        </bullet_list>
                    </list_item>
                    <list_item>
                        <paragraph>Ensure LAN connection between cinder controller and MNT port of ETERNUS DX
                            and SAN connection between Compute nodes and CA ports of ETERNUS DX.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
        <section ids="configuration" names="configuration">
            <title>Configuration</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Add the following entries to <literal>/etc/cinder/cinder.conf</literal>:</paragraph>
                    <paragraph>FC entries:</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.fujitsu.eternus_dx_fc.FJDXFCDriver
cinder_eternus_config_file = /etc/cinder/eternus_dx.xml</literal_block>
                    <paragraph>iSCSI entries:</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">volume_driver = cinder.volume.drivers.fujitsu.eternus_dx_iscsi.FJDXISCSIDriver
cinder_eternus_config_file = /etc/cinder/eternus_dx.xml</literal_block>
                    <paragraph>If there is no description about <literal>cinder_eternus_config_file</literal>,
                        then the parameter is set to default value
                        <literal>/etc/cinder/cinder_fujitsu_eternus_dx.xml</literal>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a driver configuration file.</paragraph>
                    <paragraph>Create a driver configuration file in the file path specified
                        as <literal>cinder_eternus_config_file</literal> in <literal>cinder.conf</literal>,
                        and add parameters to the file as below:</paragraph>
                    <paragraph>FC configuration:</paragraph>
                    <literal_block highlight_args="{}" language="xml" linenos="False" xml:space="preserve">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;FUJITSU&gt;
&lt;EternusIP&gt;0.0.0.0&lt;/EternusIP&gt;
&lt;EternusPort&gt;5988&lt;/EternusPort&gt;
&lt;EternusUser&gt;smisuser&lt;/EternusUser&gt;
&lt;EternusPassword&gt;smispassword&lt;/EternusPassword&gt;
&lt;EternusPool&gt;raid5_0001&lt;/EternusPool&gt;
&lt;EternusSnapPool&gt;raid5_0001&lt;/EternusSnapPool&gt;
&lt;/FUJITSU&gt;</literal_block>
                    <paragraph>iSCSI configuration:</paragraph>
                    <literal_block highlight_args="{}" language="xml" linenos="False" xml:space="preserve">&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;FUJITSU&gt;
&lt;EternusIP&gt;0.0.0.0&lt;/EternusIP&gt;
&lt;EternusPort&gt;5988&lt;/EternusPort&gt;
&lt;EternusUser&gt;smisuser&lt;/EternusUser&gt;
&lt;EternusPassword&gt;smispassword&lt;/EternusPassword&gt;
&lt;EternusPool&gt;raid5_0001&lt;/EternusPool&gt;
&lt;EternusSnapPool&gt;raid5_0001&lt;/EternusSnapPool&gt;
&lt;EternusISCSIIP&gt;1.1.1.1&lt;/EternusISCSIIP&gt;
&lt;EternusISCSIIP&gt;1.1.1.2&lt;/EternusISCSIIP&gt;
&lt;EternusISCSIIP&gt;1.1.1.3&lt;/EternusISCSIIP&gt;
&lt;EternusISCSIIP&gt;1.1.1.4&lt;/EternusISCSIIP&gt;
&lt;/FUJITSU&gt;</literal_block>
                    <paragraph>Where:</paragraph>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>EternusIP</literal></term>
                            <definition>
                                <paragraph>IP address for the SMI-S connection of the ETRENUS DX.</paragraph>
                                <paragraph>Enter the IP address of MNT port of the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusPort</literal></term>
                            <definition>
                                <paragraph>Port number for the SMI-S connection port of the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusUser</literal></term>
                            <definition>
                                <paragraph>User name for the SMI-S connection of the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusPassword</literal></term>
                            <definition>
                                <paragraph>Password for the SMI-S connection of the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusPool</literal></term>
                            <definition>
                                <paragraph>Storage pool name for volumes.</paragraph>
                                <paragraph>Enter RAID Group name or TPP name in the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusSnapPool</literal></term>
                            <definition>
                                <paragraph>Storage pool name for snapshots.</paragraph>
                                <paragraph>Enter RAID Group name in the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                        <definition_list_item>
                            <term><literal>EternusISCSIIP</literal> (Multiple setting allowed)</term>
                            <definition>
                                <paragraph>iSCSI connection IP address of the ETERNUS DX.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                    <note>
                        <bullet_list bullet="*">
                            <list_item>
                                <paragraph>For <literal>EternusSnapPool</literal>, you can specify only RAID Group name
                                    and cannot specify TPP name.</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph>You can specify the same RAID Group name for <literal>EternusPool</literal> and <literal>EternusSnapPool</literal>
                                    if you create volumes and snapshots on a same storage pool.</paragraph>
                            </list_item>
                        </bullet_list>
                    </note>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="configuration-example" names="configuration\ example">
            <title>Configuration example</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Edit <literal>cinder.conf</literal>:</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
enabled_backends = DXFC, DXISCSI

[DXFC]
volume_driver = cinder.volume.drivers.fujitsu.eternus_dx_fc.FJDXFCDriver
cinder_eternus_config_file = /etc/cinder/fc.xml
volume_backend_name = FC

[DXISCSI]
volume_driver = cinder.volume.drivers.fujitsu.eternus_dx_iscsi.FJDXISCSIDriver
cinder_eternus_config_file = /etc/cinder/iscsi.xml
volume_backend_name = ISCSI</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Create the driver configuration files <literal>fc.xml</literal> and <literal>iscsi.xml</literal>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a volume type and set extra specs to the type:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume type create DX_FC
$ openstack volume type set --property volume_backend_name=FC DX_FX
$ openstack volume type create DX_ISCSI
$ openstack volume type set --property volume_backend_name=ISCSI DX_ISCSI</literal_block>
                    <paragraph>By issuing these commands,
                        the volume type <literal>DX_FC</literal> is associated with the <literal>FC</literal>,
                        and the type <literal>DX_ISCSI</literal> is associated with the <literal>ISCSI</literal>.</paragraph>
                </list_item>
            </enumerated_list>
        </section>
    </section>
</document>
