<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/cinder/doc/source/configuration/block-storage/drivers/hpe-lefthand-driver.rst">
    <section ids="hpe-lefthand-storevirtual-driver" names="hpe\ lefthand/storevirtual\ driver">
        <title>HPE LeftHand/StoreVirtual driver</title>
        <paragraph>The <literal>HPELeftHandISCSIDriver</literal> is based on the Block Storage service plug-in
            architecture. Volume operations are run by communicating with the HPE
            LeftHand/StoreVirtual system over HTTPS, or SSH connections. HTTPS
            communications use the <literal>python-lefthandclient</literal>, which is part of the Python
            standard library.</paragraph>
        <paragraph>The <literal>HPELeftHandISCSIDriver</literal> can be configured to run using a REST client to
            communicate with the array. For performance improvements and new functionality
            the <literal>python-lefthandclient</literal> must be downloaded, and HP LeftHand/StoreVirtual
            Operating System software version 11.5 or higher is required on the array. To
            configure the driver in standard mode, see
            <reference name="HPE LeftHand/StoreVirtual REST driver" refid="hpe-lefthand-storevirtual-rest-driver">HPE LeftHand/StoreVirtual REST driver</reference>.</paragraph>
        <paragraph>For information about how to manage HPE LeftHand/StoreVirtual storage systems,
            see the HPE LeftHand/StoreVirtual user documentation.</paragraph>
        <section ids="hpe-lefthand-storevirtual-rest-driver" names="hpe\ lefthand/storevirtual\ rest\ driver">
            <title>HPE LeftHand/StoreVirtual REST driver</title>
            <paragraph>This section describes how to configure the HPE LeftHand/StoreVirtual Block
                Storage driver.</paragraph>
            <section ids="system-requirements" names="system\ requirements">
                <title>System requirements</title>
                <paragraph>To use the HPE LeftHand/StoreVirtual driver, do the following:</paragraph>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Install LeftHand/StoreVirtual Operating System software version 11.5 or
                            higher on the HPE LeftHand/StoreVirtual storage system.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a cluster group.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Install the <literal>python-lefthandclient</literal> version 2.1.0 from the Python Package
                            Index on the system with the enabled Block Storage service
                            volume drivers.</paragraph>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="supported-operations" names="supported\ operations">
                <title>Supported operations</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Create, delete, attach, and detach volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create, list, and delete volume snapshots.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a volume from a snapshot.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Copy an image to a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Copy a volume to an image.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Clone a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Extend a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Get volume statistics.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Migrate a volume with back-end assistance.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Retype a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Manage and unmanage a volume.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Manage and unmanage a snapshot.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Replicate host volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Fail-over host volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Fail-back host volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create, delete, update, snapshot, and clone generic volume groups.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create and delete generic volume group snapshots.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Create a generic volume group from a group snapshot or another group.</paragraph>
                    </list_item>
                </bullet_list>
                <paragraph>When you use back end assisted volume migration, both source and destination
                    clusters must be in the same HPE LeftHand/StoreVirtual management group.
                    The HPE LeftHand/StoreVirtual array will use native LeftHand APIs to migrate
                    the volume. The volume cannot be attached or have snapshots to migrate.</paragraph>
                <paragraph>Volume type support for the driver includes the ability to set the
                    following capabilities in the Block Storage API
                    <literal>cinder.api.contrib.types_extra_specs</literal> volume type extra specs
                    extension module.</paragraph>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph><literal>hpelh:provisioning</literal></paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>hpelh:ao</literal></paragraph>
                    </list_item>
                    <list_item>
                        <paragraph><literal>hpelh:data_pl</literal></paragraph>
                    </list_item>
                </bullet_list>
                <paragraph>To work with the default filter scheduler, the key-value pairs are
                    case-sensitive and scoped with <literal>hpelh:</literal>. For information about how to set
                    the key-value pairs and associate them with a volume type, run the following
                    command:</paragraph>
                <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack help volume type</literal_block>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>The following keys require the HPE LeftHand/StoreVirtual storage
                            array be configured for:</paragraph>
                        <definition_list>
                            <definition_list_item>
                                <term><literal>hpelh:ao</literal></term>
                                <definition>
                                    <paragraph>The HPE LeftHand/StoreVirtual storage array must be configured for
                                        Adaptive Optimization.</paragraph>
                                </definition>
                            </definition_list_item>
                            <definition_list_item>
                                <term><literal>hpelh:data_pl</literal></term>
                                <definition>
                                    <paragraph>The HPE LeftHand/StoreVirtual storage array must be able to support the
                                        Data Protection level specified by the extra spec.</paragraph>
                                </definition>
                            </definition_list_item>
                        </definition_list>
                    </list_item>
                    <list_item>
                        <paragraph>If volume types are not used or a particular key is not set for a volume
                            type, the following defaults are used:</paragraph>
                        <definition_list>
                            <definition_list_item>
                                <term><literal>hpelh:provisioning</literal></term>
                                <definition>
                                    <paragraph>Defaults to <literal>thin</literal> provisioning, the valid values are, <literal>thin</literal> and
                                        <literal>full</literal></paragraph>
                                </definition>
                            </definition_list_item>
                            <definition_list_item>
                                <term><literal>hpelh:ao</literal></term>
                                <definition>
                                    <paragraph>Defaults to <literal>true</literal>, the valid values are, <literal>true</literal> and <literal>false</literal>.</paragraph>
                                </definition>
                            </definition_list_item>
                            <definition_list_item>
                                <term><literal>hpelh:data_pl</literal></term>
                                <definition>
                                    <paragraph>Defaults to <literal>r-0</literal>, Network RAID-0 (None), the valid values are,</paragraph>
                                    <bullet_list bullet="*">
                                        <list_item>
                                            <paragraph><literal>r-0</literal>, Network RAID-0 (None)</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal>r-5</literal>, Network RAID-5 (Single Parity)</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal>r-10-2</literal>, Network RAID-10 (2-Way Mirror)</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal>r-10-3</literal>, Network RAID-10 (3-Way Mirror)</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal>r-10-4</literal>, Network RAID-10 (4-Way Mirror)</paragraph>
                                        </list_item>
                                        <list_item>
                                            <paragraph><literal>r-6</literal>, Network RAID-6 (Dual Parity)</paragraph>
                                        </list_item>
                                    </bullet_list>
                                </definition>
                            </definition_list_item>
                        </definition_list>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="enable-the-hpe-lefthand-storevirtual-iscsi-driver" names="enable\ the\ hpe\ lefthand/storevirtual\ iscsi\ driver">
                <title>Enable the HPE LeftHand/StoreVirtual iSCSI driver</title>
                <paragraph>The <literal>HPELeftHandISCSIDriver</literal> is installed with the OpenStack software.</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Install the <literal>python-lefthandclient</literal> Python package on the OpenStack Block
                            Storage system.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ pip install 'python-lefthandclient&gt;=2.1,&lt;3.0'</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>If you are not using an existing cluster, create a cluster on the HPE
                            LeftHand storage system to be used as the cluster for creating volumes.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Make the following changes in the <literal>/etc/cinder/cinder.conf</literal> file:</paragraph>
                        <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># LeftHand WS API Server URL
hpelefthand_api_url=https://10.10.0.141:8081/lhos

# LeftHand Super user username
hpelefthand_username=lhuser

# LeftHand Super user password
hpelefthand_password=lhpass

# LeftHand cluster to use for volume creation
hpelefthand_clustername=ClusterLefthand

# LeftHand iSCSI driver
volume_driver=cinder.volume.drivers.hpe.hpe_lefthand_iscsi.HPELeftHandISCSIDriver

# Should CHAPS authentication be used (default=false)
hpelefthand_iscsi_chap_enabled=false

# Enable HTTP debugging to LeftHand (default=false)
hpelefthand_debug=false

# The ratio of oversubscription when thin provisioned volumes are
# involved. Default ratio is 20.0, this means that a provisioned capacity
# can be 20 times of the total physical capacity.
max_over_subscription_ratio=20.0

# This flag represents the percentage of reserved back-end capacity.
reserved_percentage=15</literal_block>
                        <paragraph>You can enable only one driver on each cinder instance unless you enable
                            multiple back end support. See the Cinder multiple back end support
                            instructions to enable this feature.</paragraph>
                        <paragraph>If the <literal>hpelefthand_iscsi_chap_enabled</literal> is set to <literal>true</literal>, the driver
                            will associate randomly-generated CHAP secrets with all hosts on the HPE
                            LeftHand/StoreVirtual system. OpenStack Compute nodes use these secrets
                            when creating iSCSI connections.</paragraph>
                        <important>
                            <paragraph>CHAP secrets are passed from OpenStack Block Storage to Compute in clear
                                text. This communication should be secured to ensure that CHAP secrets
                                are not discovered.</paragraph>
                        </important>
                        <note>
                            <paragraph>CHAP secrets are added to existing hosts as well as newly-created ones.
                                If the CHAP option is enabled, hosts will not be able to access the
                                storage without the generated secrets.</paragraph>
                        </note>
                    </list_item>
                    <list_item>
                        <paragraph>Save the changes to the <literal>cinder.conf</literal> file and restart the
                            <literal>cinder-volume</literal> service.</paragraph>
                    </list_item>
                </enumerated_list>
                <paragraph>The HPE LeftHand/StoreVirtual driver is now enabled on your OpenStack system.
                    If you experience problems, review the Block Storage service log files for
                    errors.</paragraph>
                <note>
                    <paragraph>Previous versions implement a HPE LeftHand/StoreVirtual CLIQ driver that
                        enable the Block Storage service driver configuration in legacy mode. This
                        is removed from Mitaka onwards.</paragraph>
                </note>
            </section>
        </section>
    </section>
</document>
