<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/admin/shared-file-systems-manage-and-unmanage-share.rst">
    <target refid="shared-file-systems-manage-and-unmanage-share"></target>
    <section ids="manage-and-unmanage-share shared-file-systems-manage-and-unmanage-share" names="manage\ and\ unmanage\ share shared_file_systems_manage_and_unmanage_share">
        <title>Manage and unmanage share</title>
        <paragraph>To <literal>manage</literal> a share means that an administrator, rather than a share
            driver, manages the storage lifecycle. This approach is appropriate when an
            administrator already has the custom non-manila share with its size, shared
            file system protocol, and export path, and an administrator wants to
            register it in the Shared File System service.</paragraph>
        <paragraph>To <literal>unmanage</literal> a share means to unregister a specified share from the Shared
            File Systems service. Administrators can revert an unmanaged share to managed
            status if needed.</paragraph>
        <target refid="unmanage-share"></target>
        <section ids="unmanage-a-share unmanage-share" names="unmanage\ a\ share unmanage_share">
            <title>Unmanage a share</title>
            <paragraph>The <literal>unmanage</literal> operation is not supported for shares that were
                created on top of share servers and created with share networks.
                The Share service should have the
                option <literal>driver_handles_share_servers = False</literal>
                set in the <literal>manila.conf</literal> file. You can unmanage a share that has
                no dependent snapshots.</paragraph>
            <paragraph>To unmanage managed share, run the <literal_strong classes="command">manila unmanage &lt;share&gt;</literal_strong>
                command. Then try to print the information about the share. The
                returned result should indicate that Shared File Systems service wonâ€™t
                find the share:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila unmanage share_for_docs
$ manila show share_for_docs
ERROR: No share with a name or ID of 'share_for_docs' exists.</literal_block>
            <target refid="manage-share"></target>
        </section>
        <section ids="manage-a-share manage-share" names="manage\ a\ share manage_share">
            <title>Manage a share</title>
            <paragraph>To register the non-managed share in the File System service, run the
                <literal_strong classes="command">manila manage</literal_strong> command:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">manila manage [--name &lt;name&gt;] [--description &lt;description&gt;]
              [--share_type &lt;share-type&gt;]
              [--driver_options [&lt;key=value&gt; [&lt;key=value&gt; ...]]]
              &lt;service_host&gt; &lt;protocol&gt; &lt;export_path&gt;</literal_block>
            <paragraph>The positional arguments are:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>service_host. The manage-share service host in
                        <literal>host@backend#POOL</literal> format, which consists of the host name for
                        the back end, the name of the back end, and the pool name for the
                        back end.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>protocol. The Shared File Systems protocol of the share to manage. Valid
                        values are NFS, CIFS, GlusterFS, or HDFS.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>export_path. The share export path in the format appropriate for the
                        protocol:</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>NFS protocol. 10.0.0.1:/foo_path.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>CIFS protocol. \10.0.0.1\foo_name_of_cifs_share.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>HDFS protocol. hdfs://10.0.0.1:foo_port/foo_share_name.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>GlusterFS. 10.0.0.1:/foo_volume.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
            <paragraph>The <literal>driver_options</literal> is an optional set of one or more key and value pairs
                that describe driver options. Note that the share type must have the
                <literal>driver_handles_share_servers = False</literal> option. As a result, a special share
                type named <literal>for_managing</literal> was used in example.</paragraph>
            <paragraph>To manage share, run:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila manage \
    manila@paris#shares \
    nfs \
    1.0.0.4:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f \
    --name share_for_docs \
    --description "We manage share." \
    --share_type for_managing
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | manage_starting                      |
| share_type_name             | for_managing                         |
| description                 | We manage share.                     |
| availability_zone           | None                                 |
| share_network_id            | None                                 |
| share_server_id             | None                                 |
| host                        | manila@paris#shares                  |
| access_rules_status         | active                               |
| snapshot_id                 | None                                 |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | ddfb1240-ed5e-4071-a031-b842035a834a |
| size                        | None                                 |
| name                        | share_for_docs                       |
| share_type                  | 14ee8575-aac2-44af-8392-d9c9d344f392 |
| has_replicas                | False                                |
| replication_type            | None                                 |
| created_at                  | 2016-03-25T15:22:43.000000           |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 907004508ef4447397ce6741a8f037c1     |
| metadata                    | {}                                   |
+-----------------------------+--------------------------------------+</literal_block>
            <paragraph>Check that the share is available:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila show share_for_docs
+----------------------+--------------------------------------------------------------------------+
| Property             | Value                                                                    |
+----------------------+--------------------------------------------------------------------------+
| status               | available                                                                |
| share_type_name      | for_managing                                                             |
| description          | We manage share.                                                         |
| availability_zone    | None                                                                     |
| share_network_id     | None                                                                     |
| export_locations     |                                                                          |
|                      | path = 1.0.0.4:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f |
|                      | preferred = False                                                        |
|                      | is_admin_only = False                                                    |
|                      | id = d4d048bf-4159-4a94-8027-e567192b8d30                                |
|                      | share_instance_id = 4c8e3887-4f9a-4775-bab4-e5840a09c34e                 |
|                      | path = 2.0.0.3:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f |
|                      | preferred = False                                                        |
|                      | is_admin_only = True                                                     |
|                      | id = 1dd4f0a3-778d-486a-a851-b522f6e7cf5f                                |
|                      | share_instance_id = 4c8e3887-4f9a-4775-bab4-e5840a09c34e                 |
| share_server_id      | None                                                                     |
| host                 | manila@paris#shares                                                      |
| access_rules_status  | active                                                                   |
| snapshot_id          | None                                                                     |
| is_public            | False                                                                    |
| task_state           | None                                                                     |
| snapshot_support     | True                                                                     |
| id                   | ddfb1240-ed5e-4071-a031-b842035a834a                                     |
| size                 | 1                                                                        |
| name                 | share_for_docs                                                           |
| share_type           | 14ee8575-aac2-44af-8392-d9c9d344f392                                     |
| has_replicas         | False                                                                    |
| replication_type     | None                                                                     |
| created_at           | 2016-03-25T15:22:43.000000                                               |
| share_proto          | NFS                                                                      |
| consistency_group_id | None                                                                     |
| project_id           | 907004508ef4447397ce6741a8f037c1                                         |
| metadata             | {}                                                                       |
+----------------------+--------------------------------------------------------------------------+</literal_block>
        </section>
    </section>
</document>
