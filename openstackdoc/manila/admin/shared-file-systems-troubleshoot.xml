<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/admin/shared-file-systems-troubleshoot.rst">
    <target refid="shared-file-systems-troubleshoot"></target>
    <section ids="troubleshoot-shared-file-systems-service shared-file-systems-troubleshoot" names="troubleshoot\ shared\ file\ systems\ service shared_file_systems_troubleshoot">
        <title>Troubleshoot Shared File Systems service</title>
        <section ids="failures-in-share-file-systems-service-during-a-share-creation" names="failures\ in\ share\ file\ systems\ service\ during\ a\ share\ creation">
            <title>Failures in Share File Systems service during a share creation</title>
            <section dupnames="problem" ids="problem">
                <title>Problem</title>
                <paragraph>New shares can enter <literal>error</literal> state during the creation process.</paragraph>
            </section>
            <section dupnames="solution" ids="solution">
                <title>Solution</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Make sure, that share services are running in debug mode. If the debug mode
                            is not set, you will not get any tips from logs how to fix your issue.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Find what share service holds a specified share. To do that, run command
                            <literal_strong classes="command">manila show &lt;share_id_or_name&gt;</literal_strong> and find a share host in the
                            output. Host uniquely identifies what share service holds the broken share.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Look thought logs of this share service. Usually, it can be found at
                            <literal>/etc/var/log/manila-share.log</literal>. This log should contain kind of
                            traceback with extra information to help you to find the origin of issues.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
        <section ids="no-valid-host-was-found" names="no\ valid\ host\ was\ found">
            <title>No valid host was found</title>
            <section dupnames="problem" ids="id1">
                <title>Problem</title>
                <paragraph>If a share type contains invalid extra specs, the scheduler will not be
                    able to locate a valid host for the shares.</paragraph>
            </section>
            <section dupnames="solution" ids="id2">
                <title>Solution</title>
                <paragraph>To diagnose this issue, make sure that scheduler service is running in
                    debug mode. Try to create a new share and look for message <literal>Failed to
schedule create_share: No valid host was found.</literal> in
                    <literal>/etc/var/log/manila-scheduler.log</literal>.</paragraph>
                <paragraph>To solve this issue look carefully through the list of extra specs in
                    the share type, and the list of share services reported capabilities.
                    Make sure that extra specs are pointed in the right way.</paragraph>
            </section>
        </section>
        <section ids="created-share-is-unreachable" names="created\ share\ is\ unreachable">
            <title>Created share is unreachable</title>
            <section dupnames="problem" ids="id3">
                <title>Problem</title>
                <paragraph>By default, a new share does not have any active access rules.</paragraph>
            </section>
            <section dupnames="solution" ids="id4">
                <title>Solution</title>
                <paragraph>To provide access to new share, you need to create
                    appropriate access rule with the right value.
                    The value must defines access.</paragraph>
            </section>
        </section>
        <section ids="service-becomes-unavailable-after-upgrade" names="service\ becomes\ unavailable\ after\ upgrade">
            <title>Service becomes unavailable after upgrade</title>
            <section dupnames="problem" ids="id5">
                <title>Problem</title>
                <paragraph>After upgrading the Shared File Systems service from version v1 to version
                    v2.x, you must update the service endpoint in the OpenStack Identity service.
                    Otherwise, the service may become unavailable.</paragraph>
            </section>
            <section dupnames="solution" ids="id6">
                <title>Solution</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>To get the service type related to the Shared File Systems service, run:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># openstack endpoint list

# openstack endpoint show &lt;share-service-type&gt;</literal_block>
                        <paragraph>You will get the endpoints expected from running the Shared File Systems
                            service.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Make sure that these endpoints are updated. Otherwise, delete the outdated
                            endpoints and create new ones.</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
        <section ids="failures-during-management-of-internal-resources" names="failures\ during\ management\ of\ internal\ resources">
            <title>Failures during management of internal resources</title>
            <section dupnames="problem" ids="id7">
                <title>Problem</title>
                <paragraph>The Shared File System service manages internal resources effectively.
                    Administrators may need to manually adjust internal resources to
                    handle failures.</paragraph>
            </section>
            <section dupnames="solution" ids="id8">
                <title>Solution</title>
                <paragraph>Some drivers in the Shared File Systems service can create service entities,
                    like servers and networks. If it is necessary, you can log in to
                    project <literal>service</literal> and take manual control over it.</paragraph>
            </section>
        </section>
    </section>
</document>
