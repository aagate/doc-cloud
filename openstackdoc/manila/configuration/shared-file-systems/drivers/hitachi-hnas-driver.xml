<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/configuration/shared-file-systems/drivers/hitachi-hnas-driver.rst">
    <section ids="hitachi-nas-hnas-driver" names="hitachi\ nas\ (hnas)\ driver">
        <title>Hitachi NAS (HNAS) driver</title>
        <paragraph>The HNAS driver provides NFS Shared File Systems to OpenStack.</paragraph>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Hitachi NAS Platform Models 3080, 3090, 4040, 4060, 4080, and 4100.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>HNAS/SMU software version is 12.2 or higher.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>HNAS configuration and management utilities to create a storage pool (span)
                        and an EVS.</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>GUI (SMU).</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>SSC CLI.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
        </section>
        <section ids="supported-shared-filesystems-and-operations" names="supported\ shared\ filesystems\ and\ operations">
            <title>Supported shared filesystems and operations</title>
            <paragraph>The driver supports NFS and CIFS shares.</paragraph>
            <paragraph>The following operations are supported:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Create a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Deny share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a share from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Revert a share to a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Manage a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Unmanage a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Shrink a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Mount snapshots.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow snapshot access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Deny snapshot access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Manage a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Unmanage a snapshot.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="driver-options" names="driver\ options">
            <title>Driver options</title>
            <paragraph>This table contains the configuration options specific to the share driver.</paragraph>
            <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
            <target refid="manila-hds-hnas"></target>
            <table classes="config-ref-table" ids="id2 manila-hds-hnas" names="manila-hds_hnas">
                <title>Description of HDS NAS share driver configuration options</title>
                <tgroup cols="2">
                    <colspec colwidth="50"></colspec>
                    <colspec colwidth="50"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Configuration option = Default value</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Description</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><strong>[DEFAULT]</strong></paragraph>
                            </entry>
                            <entry>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_admin_network_ip</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Specify IP for mounting shares in the Admin network.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_allow_cifs_snapshot_while_mounted</literal> = <literal>False</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Boolean) By default, CIFS snapshots are not allowed to be taken when the share has clients connected because consistent point-in-time replica cannot be guaranteed for all files. Enabling this might cause inconsistent snapshots on CIFS shares.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_cluster_admin_ip0</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) The IP of the clusters admin node. Only set in HNAS multinode clusters.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_driver_helper</literal> = <literal>manila.share.drivers.hitachi.hnas.ssh.HNASSSHBackend</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Python class to be used for driver helper.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_evs_id</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) Specify which EVS this backend is assigned to.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_evs_ip</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Specify IP for mounting shares.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_file_system_name</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Specify file-system name for creating shares.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_ip</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) HNAS management interface IP for communication between Manila controller and HNAS.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_password</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) HNAS user password. Required only if private key is not provided.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_ssh_private_key</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) RSA/DSA private key value used to connect into HNAS. Required only if password is not provided.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_stalled_job_timeout</literal> = <literal>30</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(Integer) The time (in seconds) to wait for stalled HNAS jobs before aborting.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>hitachi_hnas_user</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) HNAS username Base64 String in order to perform tasks such as create file-systems and network interfaces.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><strong>[hnas1]</strong></paragraph>
                            </entry>
                            <entry>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>share_backend_name</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) The backend name for a given driver implementation.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>share_driver</literal> = <literal>manila.share.drivers.generic.GenericShareDriver</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Driver to use for share creation.</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section ids="pre-configuration-on-openstack-deployment" names="pre-configuration\ on\ openstack\ deployment">
            <title>Pre-configuration on OpenStack deployment</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Install the OpenStack environment with manila. See the
                        <reference name="OpenStack installation guide" refuri="https://docs.openstack.org/">OpenStack installation guide</reference><target ids="openstack-installation-guide" names="openstack\ installation\ guide" refuri="https://docs.openstack.org/"></target>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Configure the OpenStack networking so it can reach HNAS Management
                        interface and HNAS EVS Data interface.</paragraph>
                    <note>
                        <paragraph>In the driver mode used by HNAS Driver (DHSS = <literal>False</literal>), the driver
                            does not handle network configuration, it is up to the administrator to
                            configure it.</paragraph>
                    </note>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Configure the network of the manila-share node network to reach HNAS
                                management interface through the admin network.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Configure the network of the Compute and Networking nodes to reach HNAS
                                EVS data interface through the data network.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Example of networking architecture:</paragraph>
                            <figure align="center">
                                <image alt="Example networking scenario" candidates="{'*': 'configuration/shared-file-systems/drivers/../../figures/hds_network.jpg'}" uri="configuration/shared-file-systems/drivers/../../figures/hds_network.jpg" width="60%"></image>
                            </figure>
                        </list_item>
                        <list_item>
                            <paragraph>Edit the <literal>/etc/neutron/plugins/ml2/ml2_conf.ini</literal> file and update the
                                following settings in their respective tags. In case you use linuxbridge,
                                update bridge mappings at linuxbridge section:</paragraph>
                        </list_item>
                    </bullet_list>
                    <important>
                        <paragraph>It is mandatory that HNAS management interface is reachable from the
                            Shared File System node through the admin network, while the selected
                            EVS data interface is reachable from OpenStack Cloud, such as through
                            Neutron flat networking.</paragraph>
                    </important>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[ml2]
type_drivers = flat,vlan,vxlan,gre
mechanism_drivers = openvswitch
[ml2_type_flat]
flat_networks = physnet1,physnet2
[ml2_type_vlan]
network_vlan_ranges = physnet1:1000:1500,physnet2:2000:2500
[ovs]
bridge_mappings = physnet1:br-ex,physnet2:br-eth1</literal_block>
                    <paragraph>You may have to repeat the last line above in another file on the Compute
                        node, if it exists it is located in:
                        <literal>/etc/neutron/plugins/openvswitch/ovs_neutron_plugin.ini</literal>.</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>In case openvswitch for neutron agent, run in network node:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># ifconfig eth1 0
# ovs-vsctl add-br br-eth1
# ovs-vsctl add-port br-eth1 eth1
# ifconfig eth1 up</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Restart all neutron processes.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Create the data HNAS network in OpenStack:</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>List the available projects:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack project list</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Create a network to the given project (DEMO), providing the project name,
                                a name for the network, the name of the physical network over which the
                                virtual network is implemented, and the type of the physical mechanism by
                                which the virtual network is implemented:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack network create --project DEMO \
  --provider-network-type flat \
  --provider-physical-network physnet2 hnas_network</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Optional: List available networks:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack network list</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Create a subnet to the same project (DEMO), the gateway IP of this subnet,
                                a name for the subnet, the network name created before, and the CIDR of
                                subnet:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack subnet create --project DEMO --gateway GATEWAY \
  --subnet-range SUBNET_CIDR --network NETWORK HNAS_SUBNET</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Optional: List available subnets:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack subnet list</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>Add the subnet interface to a router, providing the router name and
                                subnet name created before:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack router add subnet SUBNET ROUTER</literal_block>
                        </list_item>
                    </bullet_list>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="pre-configuration-on-hnas" names="pre-configuration\ on\ hnas">
            <title>Pre-configuration on HNAS</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Create a file system on HNAS. See the
                        <reference name="Hitachi HNAS reference" refuri="http://www.hds.com/assets/pdf/hus-file-module-file-services-administration-guide.pdf">Hitachi HNAS reference</reference><target ids="hitachi-hnas-reference" names="hitachi\ hnas\ reference" refuri="http://www.hds.com/assets/pdf/hus-file-module-file-services-administration-guide.pdf"></target>.</paragraph>
                    <important>
                        <paragraph>Make sure that the filesystem is not created as a replication target.
                            For more information, refer to the official HNAS administration guide.</paragraph>
                    </important>
                </list_item>
                <list_item>
                    <paragraph>Prepare the HNAS EVS network.</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Create a route in HNAS to the project network:</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ console-context --evs &lt;EVS_ID_IN_USE&gt; route-net-add \
  --gateway &lt;FLAT_NETWORK_GATEWAY&gt; &lt;TENANT_PRIVATE_NETWORK&gt;</literal_block>
                            <important>
                                <paragraph>Make sure multi-tenancy is enabled and routes are configured
                                    per EVS.</paragraph>
                            </important>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ console-context --evs 3 route-net-add --gateway 192.168.1.1 \
10.0.0.0/24</literal_block>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Configure the CIFS security.</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before using CIFS shares with the HNAS driver, make sure to configure a
                                security service in the back end. For details, refer to the <reference name="Hitachi HNAS reference" refuri="http://www.hds.com/assets/pdf/hus-file-module-file-services-administration-guide.pdf">Hitachi HNAS
                                    reference</reference><target dupnames="hitachi\ hnas\ reference" ids="id1" refuri="http://www.hds.com/assets/pdf/hus-file-module-file-services-administration-guide.pdf"></target>.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="back-end-configuration" names="back\ end\ configuration">
            <title>Back end configuration</title>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Configure HNAS driver.</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Configure HNAS driver according to your environment. This example shows
                                a minimal HNAS driver configuration:</paragraph>
                            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
enabled_share_backends = hnas1
enabled_share_protocols = NFS,CIFS

[hnas1]
share_backend_name = HNAS1
share_driver = manila.share.drivers.hitachi.hnas.driver.HitachiHNASDriver
driver_handles_share_servers = False
hitachi_hnas_ip = 172.24.44.15
hitachi_hnas_user = supervisor
hitachi_hnas_password = supervisor
hitachi_hnas_evs_id = 1
hitachi_hnas_evs_ip = 10.0.1.20
hitachi_hnas_file_system_name = FS-Manila
hitachi_hnas_cifs_snapshot_while_mounted = True</literal_block>
                            <note>
                                <paragraph>The <literal>hds_hnas_cifs_snapshot_while_mounted</literal> parameter allows snapshots
                                    to be taken while CIFS shares are mounted. This parameter is set to
                                    <literal>False</literal> by default, which prevents a snapshot from being taken if the
                                    share is mounted or in use.</paragraph>
                            </note>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Optional. HNAS multi-backend configuration.</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Update the <literal>enabled_share_backends</literal> flag with the names of the back
                                ends separated by commas.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Add a section for every back end according to the example bellow:</paragraph>
                            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
enabled_share_backends = hnas1,hnas2
enabled_share_protocols = NFS,CIFS

[hnas1]
share_backend_name = HNAS1
share_driver = manila.share.drivers.hitachi.hnas.driver.HitachiHNASDriver
driver_handles_share_servers = False
hitachi_hnas_ip = 172.24.44.15
hitachi_hnas_user = supervisor
hitachi_hnas_password = supervisor
hitachi_hnas_evs_id = 1
hitachi_hnas_evs_ip = 10.0.1.20
hitachi_hnas_file_system_name = FS-Manila1
hitachi_hnas_cifs_snapshot_while_mounted = True

[hnas2]
share_backend_name = HNAS2
share_driver = manila.share.drivers.hitachi.hnas.driver.HitachiHNASDriver
driver_handles_share_servers = False
hitachi_hnas_ip = 172.24.44.15
hitachi_hnas_user = supervisor
hitachi_hnas_password = supervisor
hitachi_hnas_evs_id = 1
hitachi_hnas_evs_ip = 10.0.1.20
hitachi_hnas_file_system_name = FS-Manila2
hitachi_hnas_cifs_snapshot_while_mounted = True</literal_block>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Disable DHSS for HNAS share type configuration:</paragraph>
                    <note>
                        <paragraph>Shared File Systems requires that the share type includes the
                            <literal>driver_handles_share_servers</literal> extra-spec. This ensures that the share
                            will be created on a back end that supports the requested
                            <literal>driver_handles_share_servers</literal> capability.</paragraph>
                    </note>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila type-create hitachi False</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Optional: Add extra-specs for enabling HNAS-supported features:</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>These commands will enable various snapshot-related features that are
                                supported in HNAS.</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila type-key hitachi set snapshot_support=True
$ manila type-key hitachi set mount_snapshot_support=True
$ manila type-key hitachi set revert_to_snapshot_support=True
$ manila type-key hitachi set create_share_from_snapshot_support=True</literal_block>
                        </list_item>
                        <list_item>
                            <paragraph>To specify which HNAS back end will be created by the share, in case of
                                multiple back end setups, add an extra-spec for each share-type to match
                                a specific back end. Therefore, it is possible to specify which back end
                                the Shared File System service will use when creating a share.</paragraph>
                            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila type-key hitachi set share_backend_name=hnas1
$ manila type-key hitachi2 set share_backend_name=hnas2</literal_block>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Restart all Shared File Systems services (<literal>manila-share</literal>,
                        <literal>manila-scheduler</literal> and <literal>manila-api</literal>).</paragraph>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="share-migration" names="share\ migration">
            <title>Share migration</title>
            <paragraph>Extra configuration is needed for allowing shares to be migrated from or to
                HNAS. In the OpenStack deployment, the manila-share node needs an additional
                connection to the EVS data interface. Furthermore, make sure to add
                <literal>hitachi_hnas_admin_network_ip</literal> to the configuration. This should match the
                value of <literal>data_node_access_ip</literal>. For more in-depth documentation,
                refer to the <reference name="share migration documents" refuri="https://docs.openstack.org/admin-guide/shared-file-systems-share-migration.html">share migration documents</reference><target ids="share-migration-documents" names="share\ migration\ documents" refuri="https://docs.openstack.org/admin-guide/shared-file-systems-share-migration.html"></target></paragraph>
        </section>
        <section ids="manage-and-unmanage-shares" names="manage\ and\ unmanage\ shares">
            <title>Manage and unmanage shares</title>
            <paragraph>Shared File Systems has the ability to manage and unmanage shares. If there is
                a share in the storage and it is not in OpenStack, you can manage that share
                and use it as a Shared File Systems share. Administrators have to make sure the
                exports are under the <literal>/shares</literal> folder beforehand. HNAS drivers use
                virtual-volumes (V-VOL) to create shares. Only V-VOL shares can be used by the
                driver, and V-VOLs must have a quota limit. If the NFS export is an ordinary FS
                export, it is not possible to use it in Shared File Systems. The unmanage
                operation only unlinks the share from Shared File Systems, all data is
                preserved. Both manage and unmanage operations are non-disruptive by default,
                until access rules are modified.</paragraph>
            <paragraph>To <strong>manage</strong> a share, use:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila manage [--name &lt;name&gt;] [--description &lt;description&gt;]
                [--share_type &lt;share-type&gt;]
                [--driver_options [&lt;key=value&gt; [&lt;key=value&gt; ...]]]
                [--public]
                &lt;service_host&gt; &lt;protocol&gt; &lt;export_path&gt;</literal_block>
            <paragraph>Where:</paragraph>
            <table>
                <tgroup cols="2">
                    <colspec colwidth="20"></colspec>
                    <colspec colwidth="54"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph><strong>Parameter</strong></paragraph>
                            </entry>
                            <entry>
                                <paragraph><strong>Description</strong></paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><literal>service_host</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>Manila host, back end and share name. For example,
                                    <literal>ubuntu@hitachi1#hsp1</literal>. The available hosts can
                                    be listed with the command: <literal>manila pool-list</literal>
                                    (admin only).</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>protocol</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>Protocol of share to manage, such as NFS or CIFS.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>export_path</literal></paragraph>
                            </entry>
                            <entry>
                                <definition_list>
                                    <definition_list_item>
                                        <term>Share export path.</term>
                                        <definition>
                                            <paragraph>For NFS: <literal>10.0.0.1:/shares/share_name</literal></paragraph>
                                            <paragraph>For CIFS: <literal>\\10.0.0.1\share_name</literal></paragraph>
                                        </definition>
                                    </definition_list_item>
                                </definition_list>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <note>
                <paragraph>For NFS exports, <literal>export_path</literal> <strong>must</strong> include <literal>/shares/</literal> after the
                    target address. Trying to reference the share name directly or under another
                    path will fail.</paragraph>
            </note>
            <note>
                <paragraph>For CIFS exports, although the shares will be created under the <literal>/shares/</literal>
                    folder in the back end, only the share name is needed in the export path. It
                    should also be noted that the backslash <literal>\</literal> character has to be escaped
                    when entered in Linux terminals.</paragraph>
            </note>
            <paragraph>For additional details, refer to <literal>manila help manage</literal> or the
                <reference name="OpenStack Shared File Systems documentation" refuri="https://docs.openstack.org/admin-guide/shared-file-systems.html">OpenStack Shared File Systems documentation</reference><target ids="openstack-shared-file-systems-documentation" names="openstack\ shared\ file\ systems\ documentation" refuri="https://docs.openstack.org/admin-guide/shared-file-systems.html"></target>.</paragraph>
            <paragraph>To <strong>unmanage</strong> a share, use:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila unmanage &lt;share&gt;</literal_block>
            <paragraph>Where:</paragraph>
            <table>
                <tgroup cols="2">
                    <colspec colwidth="18"></colspec>
                    <colspec colwidth="57"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph><strong>Parameter</strong></paragraph>
                            </entry>
                            <entry>
                                <paragraph><strong>Description</strong></paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><literal>share</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>ID or name of the share to be unmanaged. A list of
                                    shares can be fetched with <literal>manila list</literal>.</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section ids="manage-and-unmanage-snapshots" names="manage\ and\ unmanage\ snapshots">
            <title>Manage and unmanage snapshots</title>
            <paragraph>The Shared File Systems service also has the ability to manage share
                snapshots. Existing HNAS snapshots can be managed, as long as the snapshot
                directory is located in <literal>/snapshots/share_ID</literal>. New snapshots created through
                the Shared File Systems service are also created according to this specific
                folder structure.</paragraph>
            <paragraph>To <strong>manage</strong> a snapshot, use:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila snapshot-manage [--name &lt;name&gt;] [--description &lt;description&gt;]
                         [--driver_options [&lt;key=value&gt; [&lt;key=value&gt; ...]]]
                         &lt;share&gt; &lt;provider_location&gt;</literal_block>
            <paragraph>Where:</paragraph>
            <table>
                <tgroup cols="2">
                    <colspec colwidth="24"></colspec>
                    <colspec colwidth="49"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph><strong>Parameter</strong></paragraph>
                            </entry>
                            <entry>
                                <paragraph><strong>Description</strong></paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><literal>share</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>ID or name of the share to be managed. A list
                                    of shares can be fetched with <literal>manila list</literal>.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>provider_location</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>Location of the snapshot on the back end, such
                                    as <literal>/snapshots/share_ID/snapshot_ID</literal>.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>--driver_options</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>Driver-related configuration, passed such as
                                    <literal>size=10</literal>.</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <note>
                <paragraph>The mandatory <literal>provider_location</literal> parameter uses the same syntax for both
                    NFS and CIFS shares. This is only the case for snapshot management.</paragraph>
            </note>
            <note>
                <paragraph>The <literal>--driver_options</literal> parameter <literal>size</literal> is <strong>required</strong> for the HNAS
                    driver. Administrators need to know the size of the to-be-managed
                    snapshot beforehand.</paragraph>
            </note>
            <note>
                <paragraph>If the <literal>mount_snapshot_support=True</literal> extra-spec is set in the share type,
                    the HNAS driver will automatically create an export when managing a snapshot
                    if one does not already exist.</paragraph>
            </note>
            <paragraph>To <strong>unmanage</strong> a snapshot, use:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila snapshot-unmanage &lt;snapshot&gt;</literal_block>
            <paragraph>Where:</paragraph>
            <table>
                <tgroup cols="2">
                    <colspec colwidth="15"></colspec>
                    <colspec colwidth="32"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph><strong>Parameter</strong></paragraph>
                            </entry>
                            <entry>
                                <paragraph><strong>Description</strong></paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><literal>snapshot</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>Name or ID of the snapshot(s).</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
        <section ids="additional-notes" names="additional\ notes">
            <title>Additional notes</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>HNAS has some restrictions about the number of EVSs, filesystems,
                        virtual-volumes, and simultaneous SSC connections. Check the manual
                        specification for your system.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Shares and snapshots are thin provisioned. It is reported to Shared File
                        System only the real used space in HNAS. Also, a snapshot does not initially
                        take any space in HNAS, it only stores the difference between the share and
                        the snapshot, so it grows when share data is changed.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Administrators should manage the project’s quota
                        (<literal_strong classes="command">manila quota-update</literal_strong>) to control the back end usage.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Shares will need to be remounted after a revert-to-snapshot operation.</paragraph>
                </list_item>
            </bullet_list>
        </section>
    </section>
</document>
