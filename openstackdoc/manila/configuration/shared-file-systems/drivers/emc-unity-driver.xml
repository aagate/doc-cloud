<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/configuration/shared-file-systems/drivers/emc-unity-driver.rst">
    <section ids="emc-unity-driver" names="emc\ unity\ driver">
        <title>EMC Unity driver</title>
        <paragraph>The EMC Shared File Systems service driver framework (EMCShareDriver)
            utilizes the EMC storage products to provide the shared file systems to
            OpenStack. The EMC driver is a plug-in based driver which is designed to
            use different plug-ins to manage different EMC storage products.</paragraph>
        <paragraph>The Unity plug-in manages the Unity system to provide shared filesystems.
            The EMC driver framework with the Unity plug-in is referred to as the
            Unity driver in this document.</paragraph>
        <paragraph>This driver performs the operations on Unity through RESTful APIs. Each back
            end manages one Storage Processor of Unity. Configure multiple Shared File
            Systems service back ends to manage multiple Unity systems.</paragraph>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Unity OE 4.1.x or higher.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>StorOps 0.4.3 or higher is installed on Manila node.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Following licenses are activated on Unity:</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>CIFS/SMB Support</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Network File System (NFS)</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Thin Provisioning</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
        </section>
        <section ids="supported-shared-filesystems-and-operations" names="supported\ shared\ filesystems\ and\ operations">
            <title>Supported shared filesystems and operations</title>
            <paragraph>The driver supports CIFS and NFS shares.</paragraph>
            <paragraph>The following operations are supported:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Create a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Deny share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a share from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a share.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="supported-network-types" names="supported\ network\ types">
            <title>Supported network types</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><literal>Flat</literal></paragraph>
                    <paragraph>This type is fully supported by Unity share driver, however flat networks are
                        restricted due to the limited number of tenant networks that can be created
                        from them.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><literal>VLAN</literal></paragraph>
                    <paragraph>We recommend this type of network topology in Manila.
                        In most use cases, VLAN is used to isolate the different tenants and provide
                        an isolated network for each tenant. To support this function, an
                        administrator needs to set a slot connected with Unity Ethernet port in
                        <literal>Trunk</literal> mode or allow multiple VLANs from the slot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph><literal>VXLAN</literal></paragraph>
                    <paragraph>Unity native VXLAN is still unavailable. However, with the <reference name="HPB" refuri="http://specs.openstack.org/openstack/neutron-specs/specs/kilo/ml2-hierarchical-port-binding.html">HPB</reference><target ids="hpb" names="hpb" refuri="http://specs.openstack.org/openstack/neutron-specs/specs/kilo/ml2-hierarchical-port-binding.html"></target>
                        (Hierarchical Port Binding) in Networking and Shared file system services,
                        it is possible that Unity co-exists with VXLAN enabled network environment.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="supported-mtu-size" names="supported\ mtu\ size">
            <title>Supported MTU size</title>
            <paragraph>Unity currently only supports 1500 and 9000 as the mtu size, the user can
                change the above mtu size from Unity Unisphere:</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>In the Unisphere, go to <title_reference>Settings</title_reference>, <title_reference>Access</title_reference>, and then <title_reference>Ethernet</title_reference>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Double click the ethernet port.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Select the <title_reference>MTU</title_reference> size from the drop down list.</paragraph>
                </list_item>
            </enumerated_list>
            <paragraph>The Unity driver will select the port where mtu is equal to the mtu
                of share network during share server creation.</paragraph>
        </section>
        <section ids="supported-security-services" names="supported\ security\ services">
            <title>Supported security services</title>
            <paragraph>Unity share driver provides <literal>IP</literal> based authentication method support for
                <literal>NFS</literal> shares and <literal>user</literal> based authentication method for <literal>CIFS</literal> shares
                respectively. For <literal>CIFS</literal> share, Microsoft Active Directory is the only
                supported security services.</paragraph>
        </section>
        <section ids="pre-configurations" names="pre-configurations">
            <title>Pre-configurations</title>
            <section ids="on-manila-node" names="on\ manila\ node">
                <title>On manila node</title>
                <paragraph>Python library <literal>storops</literal> is required to run Unity driver.
                    Install it with the <literal>pip</literal> command.
                    You may need root privilege to install python libraries.</paragraph>
                <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">pip install storops</literal_block>
            </section>
            <section ids="on-unity-system" names="on\ unity\ system">
                <title>On Unity system</title>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Configure system level NTP server.</paragraph>
                        <paragraph>Open <literal>Unisphere</literal> of your Unity system and navigate to:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">Unisphere -&gt; Settings -&gt; Management -&gt; System Time and NTP</literal_block>
                        <paragraph>Select <literal>Enable NTP synchronization</literal> and add your NTP server(s).</paragraph>
                        <paragraph>The time on the Unity system and the Active Directory domains
                            used in security services should be in sync. We recommend
                            using the same NTP server on both the Unity system and Active
                            Directory domains.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Configure system level DNS server.</paragraph>
                        <paragraph>Open <literal>Unisphere</literal> of your Unity system and navigate to:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">Unisphere -&gt; Settings -&gt; Management -&gt; DNS Server</literal_block>
                        <paragraph>Select <literal>Configure DNS server address manually</literal> and add your DNS server(s).</paragraph>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
        <section ids="back-end-configurations" names="back\ end\ configurations">
            <title>Back end configurations</title>
            <paragraph>Following configurations need to be configured in <literal>/etc/manila/manila.conf</literal>
                for the Unity driver.</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">share_driver = manila.share.drivers.dell_emc.driver.EMCShareDriver
emc_share_backend = unity
emc_nas_server = &lt;management IP address of the Unity system&gt;
emc_nas_login = &lt;user with administrator privilege&gt;
emc_nas_password = &lt;password&gt;
unity_server_meta_pool = &lt;pool name&gt;
unity_share_data_pools = &lt;comma separated pool names&gt;
unity_ethernet_ports = &lt;comma separated ports list&gt;
driver_handles_share_servers = True</literal_block>
            <bullet_list bullet="-">
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>emc_share_backend</literal></term>
                            <definition>
                                <paragraph>The plugin name. Set it to <title_reference>unity</title_reference> for the Unity driver.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>emc_nas_server</literal></term>
                            <definition>
                                <paragraph>The management IP for Unity.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>emc_nas_login</literal></term>
                            <definition>
                                <paragraph>The user with administrator privilege.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>emc_nas_passowrd</literal></term>
                            <definition>
                                <paragraph>Password for the user.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>unity_server_meta_pool</literal></term>
                            <definition>
                                <paragraph>The name of the pool to persist the meta-data of NAS server.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>unity_share_data_pools</literal></term>
                            <definition>
                                <paragraph>Comma separated list specifying the name of the pools to be used
                                    by this back end. Do not set this option if all storage pools
                                    on the system can be used.
                                    Wild card character is supported.</paragraph>
                                <paragraph>Examples:</paragraph>
                                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># Only use pool_1
unity_share_data_pools = pool_1
# Only use pools whose name stars from pool_
unity_share_data_pools = pool_*
# Use all pools on Unity
unity_share_data_pools = *</literal_block>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>unity_ethernet_ports</literal></term>
                            <definition>
                                <block_quote>
                                    <paragraph>Comma separated list specifying the ethernet ports of Unity system
                                        that can be used for share. Do not set this option if all ethernet ports
                                        can be used.
                                        Wild card character is supported. Both the normal ethernet port and link
                                        aggregation port can be used by Unity share driver.</paragraph>
                                    <paragraph>Examples:</paragraph>
                                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># Only use spa_eth1
unity_ethernet_ports = spa_eth1
# Use port whose name stars from spa_
unity_ethernet_ports = spa_*
# Use all Link Aggregation ports
unity_ethernet_ports = sp*_la_*
# Use all available ports
unity_ethernet_ports = *</literal_block>
                                </block_quote>
                                <note>
                                    <paragraph>Refer to <reference internal="True" refid="unity-file-io-load-balance"><inline classes="std std-ref">IO Load balance</inline></reference> for performance
                                        impact.</paragraph>
                                </note>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
                <list_item>
                    <definition_list>
                        <definition_list_item>
                            <term><literal>driver_handles_share_servers</literal></term>
                            <definition>
                                <paragraph>Unity driver requires this option to be as <literal>True</literal>.</paragraph>
                            </definition>
                        </definition_list_item>
                    </definition_list>
                </list_item>
            </bullet_list>
            <paragraph>Restart of <literal>manila-share</literal> service is needed for the configuration
                changes to take effect.</paragraph>
            <target refid="unity-file-io-load-balance"></target>
        </section>
        <section ids="io-load-balance unity-file-io-load-balance" names="io\ load\ balance unity_file_io_load_balance">
            <title>IO Load balance</title>
            <paragraph>The Unity driver automatically distributes the file interfaces per storage
                processor based on the option <literal>unity_ethernet_ports</literal>. This balances IO
                traffic. The recommended configuration for <literal>unity_ethernet_ports</literal> specifies
                balanced ports per storage processor. For example:</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve"># Use eth2 from both SPs
unity_ethernet_ports = spa_eth2, spb_eth2</literal_block>
        </section>
        <section ids="restrictions" names="restrictions">
            <title>Restrictions</title>
            <paragraph>The Unity driver has following restrictions.</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>EMC Unity does not support the same IP in different VLANs.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Only Active Directory security service is supported and it is
                        required to create CIFS shares.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="driver-options" names="driver\ options">
            <title>Driver options</title>
            <paragraph>Configuration options specific to this driver:</paragraph>
            <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
            <target refid="manila-unity"></target>
            <table classes="config-ref-table" ids="id1 manila-unity" names="manila-unity">
                <title>Description of Dell EMC Unity share driver configuration options</title>
                <tgroup cols="2">
                    <colspec colwidth="50"></colspec>
                    <colspec colwidth="50"></colspec>
                    <thead>
                        <row>
                            <entry>
                                <paragraph>Configuration option = Default value</paragraph>
                            </entry>
                            <entry>
                                <paragraph>Description</paragraph>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <paragraph><strong>[DEFAULT]</strong></paragraph>
                            </entry>
                            <entry>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>unity_ethernet_ports</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(List) Comma separated list of ports that can be used for share server interfaces. Members of the list can be Unix-style glob expressions.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>unity_server_meta_pool</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(String) Pool to persist the meta-data of NAS server.</paragraph>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <paragraph><literal>unity_share_data_pools</literal> = <literal>None</literal></paragraph>
                            </entry>
                            <entry>
                                <paragraph>(List) Comma separated list of pools that can be used to persist share data.</paragraph>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </section>
    </section>
</document>
