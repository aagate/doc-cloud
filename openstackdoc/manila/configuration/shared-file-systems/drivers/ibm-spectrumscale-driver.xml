<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/configuration/shared-file-systems/drivers/ibm-spectrumscale-driver.rst">
    <section ids="ibm-spectrum-scale-share-driver" names="ibm\ spectrum\ scale\ share\ driver">
        <title>IBM Spectrum Scale share driver</title>
        <paragraph>IBM Spectrum Scale is a flexible software-defined storage product that can be
            deployed as high-performance file storage or a cost optimized
            large-scale content repository. IBM Spectrum Scale, previously known as
            IBM General Parallel File System (GPFS), is designed to scale performance
            and capacity with no bottlenecks. IBM Spectrum Scale is a cluster file system
            that provides concurrent access to file systems from multiple nodes. The
            storage provided by these nodes can be direct attached, network attached, SAN
            attached, or a combination of these methods. Spectrum Scale provides many
            features beyond common data access, including data replication, policy based
            storage management, and space efficient file snapshot and clone operations.</paragraph>
        <section ids="supported-shared-filesystems-and-operations-nfs-shares-only" names="supported\ shared\ filesystems\ and\ operations\ (nfs\ shares\ only)">
            <title>Supported shared filesystems and operations (NFS shares only)</title>
            <paragraph>The Spectrum Scale share driver supports NFS shares.</paragraph>
            <paragraph>The following operations are supported:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Create a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow share access.</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>Only IP access type is supported.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Both RW &amp; RO access level is supported.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Deny share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a share snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a share snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a share from a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Extend a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Manage a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Unmanage a share.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <paragraph>Spectrum Scale must be installed and a cluster must be created that includes
                one or more storage nodes and protocol server nodes. The NFS server
                running on these nodes is used to export shares to storage consumers in
                OpenStack virtual machines or even to bare metal storage consumers in the
                OpenStack environment. A file system must also be created and
                mounted on these nodes before configuring the manila service to use Spectrum
                Scale storage. For more details, refer to <reference name="Spectrum Scale product documentation" refuri="https://ibm.biz/Bdi84g">Spectrum Scale product
                    documentation</reference><target ids="spectrum-scale-product-documentation" names="spectrum\ scale\ product\ documentation" refuri="https://ibm.biz/Bdi84g"></target>.</paragraph>
            <paragraph>Spectrum Scale supports two ways of exporting data through NFS with high
                availability.</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>CES (which uses Ganesha NFS)</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>This is provided inherently by the protocol support in Spectrum Scale
                                and is a recommended method for NFS access.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>CNFS (which uses kernel NFS)</paragraph>
                </list_item>
            </enumerated_list>
            <paragraph>For more information on NFS support in Spectrum Scale, refer to
                <reference name="Protocol support in Spectrum Scale" refuri="https://ibm.biz/BdiuZN">Protocol support in Spectrum Scale</reference><target ids="protocol-support-in-spectrum-scale" names="protocol\ support\ in\ spectrum\ scale" refuri="https://ibm.biz/BdiuZN"></target> and
                <reference name="NFS Support overview in Spectrum Scale" refuri="https://ibm.biz/BdiuZ7">NFS Support overview in Spectrum Scale</reference><target ids="nfs-support-overview-in-spectrum-scale" names="nfs\ support\ overview\ in\ spectrum\ scale" refuri="https://ibm.biz/BdiuZ7"></target>.</paragraph>
            <paragraph>The following figure is an example of Spectrum Scale architecture
                with OpenStack services:</paragraph>
            <figure align="center">
                <image alt="OpenStack with Spectrum Scale Setup" candidates="{'*': 'configuration/shared-file-systems/drivers/../../figures/openstack-spectrumscale-setup.JPG'}" uri="configuration/shared-file-systems/drivers/../../figures/openstack-spectrumscale-setup.JPG" width="90%"></image>
            </figure>
            <paragraph>Quotas should be enabled for the Spectrum Scale filesystem to be exported
                through NFS using Spectrum Scale share driver.
                Use the following command to enable quota for a filesystem:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ mmchfs &lt;filesystem&gt; -Q yes</literal_block>
        </section>
        <section ids="limitation" names="limitation">
            <title>Limitation</title>
            <paragraph>Spectrum Scale share driver currently supports creation of NFS shares in the
                flat network space only. For example, the Spectrum Scale storage node exporting
                the data should be in the same network as that of the Compute VMs which mount
                the shares acting as NFS clients.</paragraph>
        </section>
        <section ids="driver-configuration" names="driver\ configuration">
            <title>Driver configuration</title>
            <paragraph>Spectrum Scale share driver supports creation of shares using both NFS servers
                (Ganesha using Spectrum Scale CES/Kernel NFS).</paragraph>
            <paragraph>For both the NFS server types, you need to set the <literal>share_driver</literal> in the
                <literal>manila.conf</literal> as:</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">share_driver = manila.share.drivers.ibm.gpfs.GPFSShareDriver</literal_block>
            <section ids="spectrum-scale-ces-nfs-ganesha-server" names="spectrum\ scale\ ces\ (nfs\ ganesha\ server)">
                <title>Spectrum Scale CES (NFS Ganesha server)</title>
                <paragraph>To use Spectrum Scale share driver in this mode, set the <literal>gpfs_share_helpers</literal>
                    in the <literal>manila.conf</literal> as:</paragraph>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">gpfs_share_helpers = CES=manila.share.drivers.ibm.gpfs.CESHelper</literal_block>
                <paragraph>Following table lists the additional configuration options which are used with
                    this driver configuration.</paragraph>
                <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
                <target refid="manila-spectrumscale-ces"></target>
                <table classes="config-ref-table" ids="id1 manila-spectrumscale-ces" names="manila-spectrumscale_ces">
                    <title>Description of IBM Spectrum Scale CES share driver configuration options</title>
                    <tgroup cols="2">
                        <colspec colwidth="50"></colspec>
                        <colspec colwidth="50"></colspec>
                        <thead>
                            <row>
                                <entry>
                                    <paragraph>Configuration option = Default value</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Description</paragraph>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph><strong>[DEFAULT]</strong></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_mount_point_base</literal> = <literal>$state_path/mnt</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) Base folder where exported shares are located.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_nfs_server_type</literal> = <literal>CES</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) NFS Server type. Valid choices are “CES” (Ganesha NFS) or “KNFS” (Kernel NFS).</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_share_export_ip</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Host address) IP to be added to GPFS export string.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_share_helpers</literal> = <literal>KNFS=manila.share.drivers.ibm.gpfs.KNFSHelper, CES=manila.share.drivers.ibm.gpfs.CESHelper</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(List) Specify list of share export helpers.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_login</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) GPFS server SSH login name.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_password</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) GPFS server SSH login password. The password is not needed, if ‘gpfs_ssh_private_key’ is configured.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_port</literal> = <literal>22</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Port number) GPFS server SSH port.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_private_key</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) Path to GPFS server SSH private key for login.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>is_gpfs_node</literal> = <literal>False</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Boolean) True:when Manila services are running on one of the Spectrum Scale node. False:when Manila services are not running on any of the Spectrum Scale node.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <note>
                    <paragraph>Configuration options related to ssh are required only if <literal>is_gpfs_node</literal>
                        is set to <literal>False</literal>.</paragraph>
                </note>
            </section>
            <section ids="spectrum-scale-clustered-nfs-kernel-nfs-server" names="spectrum\ scale\ clustered\ nfs\ (kernel\ nfs\ server)">
                <title>Spectrum Scale Clustered NFS (Kernel NFS server)</title>
                <paragraph>To use Spectrum Scale share driver in this mode, set the <literal>gpfs_share_helpers</literal>
                    in the <literal>manila.conf</literal> as:</paragraph>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">gpfs_share_helpers = KNFS=manila.share.drivers.ibm.gpfs.KNFSHelper</literal_block>
                <paragraph>Following table lists the additional configuration options which are used with
                    this driver configuration.</paragraph>
                <comment xml:space="preserve">Warning: Do not edit this file. It is automatically generated from the
software project's code and your changes will be overwritten.

The tool to generate this file lives in openstack-doc-tools repository.

Please make any changes needed in the code, then run the
autogenerate-config-doc tool from the openstack-doc-tools repository, or
ask for help on the documentation mailing list, IRC channel or meeting.</comment>
                <target refid="manila-spectrumscale-knfs"></target>
                <table classes="config-ref-table" ids="id2 manila-spectrumscale-knfs" names="manila-spectrumscale_knfs">
                    <title>Description of IBM Spectrum Scale KNFS share driver configuration options</title>
                    <tgroup cols="2">
                        <colspec colwidth="50"></colspec>
                        <colspec colwidth="50"></colspec>
                        <thead>
                            <row>
                                <entry>
                                    <paragraph>Configuration option = Default value</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>Description</paragraph>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph><strong>[DEFAULT]</strong></paragraph>
                                </entry>
                                <entry>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_mount_point_base</literal> = <literal>$state_path/mnt</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) Base folder where exported shares are located.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_nfs_server_list</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(List) A list of the fully qualified NFS server names that make up the OpenStack Manila configuration.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_nfs_server_type</literal> = <literal>CES</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) NFS Server type. Valid choices are “CES” (Ganesha NFS) or “KNFS” (Kernel NFS).</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_share_export_ip</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Host address) IP to be added to GPFS export string.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_share_helpers</literal> = <literal>KNFS=manila.share.drivers.ibm.gpfs.KNFSHelper, CES=manila.share.drivers.ibm.gpfs.CESHelper</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(List) Specify list of share export helpers.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_login</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) GPFS server SSH login name.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_password</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) GPFS server SSH login password. The password is not needed, if ‘gpfs_ssh_private_key’ is configured.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_port</literal> = <literal>22</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Port number) GPFS server SSH port.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>gpfs_ssh_private_key</literal> = <literal>None</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(String) Path to GPFS server SSH private key for login.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph><literal>is_gpfs_node</literal> = <literal>False</literal></paragraph>
                                </entry>
                                <entry>
                                    <paragraph>(Boolean) True:when Manila services are running on one of the Spectrum Scale node. False:when Manila services are not running on any of the Spectrum Scale node.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <note>
                    <paragraph>Configuration options related to ssh are required only if <literal>is_gpfs_node</literal>
                        is set to <literal>False</literal>.</paragraph>
                </note>
            </section>
        </section>
        <section ids="share-creation-steps" names="share\ creation\ steps">
            <title>Share creation steps</title>
            <section ids="sample-configuration" names="sample\ configuration">
                <title>Sample configuration</title>
                <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[gpfs]
share_driver = manila.share.drivers.ibm.gpfs.GPFSShareDriver
gpfs_share_export_ip = x.x.x.x
gpfs_mount_point_base = /ibm/gpfs0
gpfs_nfs_server_type = CES
is_gpfs_node = True
gpfs_share_helpers = CES=manila.share.drivers.ibm.gpfs.CESHelper
share_backend_name = GPFS
driver_handles_share_servers = False</literal_block>
            </section>
            <section ids="create-gpfs-share-type-and-set-extra-spec" names="create\ gpfs\ share\ type\ and\ set\ extra\ spec">
                <title>Create GPFS share type and set extra spec</title>
                <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ manila type-create --snapshot_support True \
  --create_share_from_snapshot_support True gpfs False

$ manila type-key gpfs set share_backend_name=GPFS</literal_block>
            </section>
        </section>
    </section>
</document>
