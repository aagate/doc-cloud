<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/manila/doc/source/configuration/shared-file-systems/drivers/glusterfs-native-driver.rst">
    <section ids="glusterfs-native-driver" names="glusterfs\ native\ driver">
        <title>GlusterFS Native driver</title>
        <paragraph>GlusterFS Native driver uses GlusterFS, an open source distributed file
            system, as the storage back end for serving file shares to Shared File
            Systems service clients.</paragraph>
        <paragraph>A Shared File Systems service share is a GlusterFS volume. This driver
            uses flat-network (share-server-less) model. Instances directly talk
            with the GlusterFS back end storage pool. The instances use <literal>glusterfs</literal>
            protocol to mount the GlusterFS shares. Access to each share is allowed
            via TLS Certificates. Only the instance which has the TLS trust
            established with the GlusterFS back end can mount and hence use the
            share. Currently only <literal>read-write (rw)</literal> access is supported.</paragraph>
        <section ids="network-approach" names="network\ approach">
            <title>Network approach</title>
            <paragraph>L3 connectivity between the storage back end and the host running the
                Shared File Systems share service should exist.</paragraph>
        </section>
        <section ids="multi-tenancy-model" names="multi-tenancy\ model">
            <title>Multi-tenancy model</title>
            <paragraph>The driver does not support network segmented multi-tenancy model.
                Instead multi-tenancy is supported using tenant specific TLS
                certificates.</paragraph>
        </section>
        <section ids="supported-shared-filesystems-and-operations" names="supported\ shared\ filesystems\ and\ operations">
            <title>Supported shared filesystems and operations</title>
            <paragraph>The driver supports GlusterFS shares.</paragraph>
            <paragraph>The following operations are supported:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Create a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a share.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Allow share access.</paragraph>
                    <paragraph>Note the following limitations:</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>Only access by TLS Certificates (<literal>cert</literal> access type) is supported.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Only read-write access is supported.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Deny share access.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Create a snapshot.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Delete a snapshot.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Install glusterfs-server package, version &gt;= 3.6.x, on the storage
                        back end.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Install glusterfs and glusterfs-fuse package, version &gt;= 3.6.x, on the
                        Shared File Systems service host.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Establish network connection between the Shared File Systems service
                        host and the storage back end.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="shared-file-systems-service-driver-configuration-setting" names="shared\ file\ systems\ service\ driver\ configuration\ setting">
            <title>Shared File Systems service driver configuration setting</title>
            <paragraph>The following parameters in the Shared File Systems serviceâ€™s
                configuration file need to be set:</paragraph>
            <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">share_driver = manila.share.drivers.glusterfs_native.GlusterfsNativeShareDriver
glusterfs_servers = glustervolserver
glusterfs_volume_pattern = manila-share-volume-\d+$</literal_block>
            <paragraph>The parameters are:</paragraph>
            <definition_list>
                <definition_list_item>
                    <term><literal>glusterfs_servers</literal></term>
                    <definition>
                        <paragraph>List of GlusterFS servers which provide volumes that can be used to
                            create shares. The servers are expected to be of distinct Gluster
                            clusters, so they should not be Gluster peers. Each server should
                            be of the form <literal>[&lt;remoteuser&gt;@]&lt;glustervolserver&gt;</literal>.</paragraph>
                        <paragraph>The optional <literal>&lt;remoteuser&gt;@</literal> part of the server URI indicates
                            SSH access for cluster management (see related optional
                            parameters below). If it is not given, direct command line
                            management is performed (the Shared File Systems service host is
                            assumed to be part of the GlusterFS cluster the server belongs
                            to).</paragraph>
                    </definition>
                </definition_list_item>
                <definition_list_item>
                    <term><literal>glusterfs_volume_pattern</literal></term>
                    <definition>
                        <paragraph>Regular expression template used to filter GlusterFS volumes for
                            share creation. The regular expression template can contain the
                            <literal>#{size}</literal> parameter which matches a number and the value will be
                            interpreted as size of the volume in GB. Examples:
                            <literal>manila-share-volume-\d+$</literal>,
                            <literal>manila-share-volume-#{size}G-\d+$</literal>; with matching volume names,
                            respectively: <literal>manila-share-volume-12</literal>,
                            <literal>manila-share-volume-3G-13</literal>. In the latter example, the number
                            that matches <literal>#{size}</literal>, which is 3, is an indication that the
                            size of volume is 3 GB. On share creation, the Shared File Systems
                            service picks volumes at least as large as the requested one.</paragraph>
                    </definition>
                </definition_list_item>
            </definition_list>
            <paragraph>When setting up GlusterFS shares, note the following:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>GlusterFS volumes are not created on demand. A pre-existing set of
                        GlusterFS volumes should be supplied by the GlusterFS cluster(s),
                        conforming to the naming convention encoded by
                        <literal>glusterfs_volume_pattern</literal>. However, the GlusterFS endpoint is
                        allowed to extend this set any time, so the Shared File Systems
                        service and GlusterFS endpoints are expected to communicate volume
                        supply and demand out-of-band.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Certificate setup, also known as trust setup, between instance and
                        storage back end is out of band of the Shared File Systems service.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>For the Shared File Systems service to use GlusterFS volumes, the
                        name of the trashcan directory in GlusterFS volumes must not be
                        changed from the default.</paragraph>
                </list_item>
            </bullet_list>
        </section>
    </section>
</document>
