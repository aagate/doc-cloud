<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/glance/doc/source/admin/db-sqlalchemy-migrate.rst">
    <comment xml:space="preserve">Copyright 2012 OpenStack Foundation
All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may
not use this file except in compliance with the License. You may obtain
a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations
under the License.</comment>
    <target refid="legacy-database-management"></target>
    <section ids="legacy-database-management id1" names="legacy\ database\ management legacy-database-management">
        <title>Legacy Database Management</title>
        <note>
            <paragraph>This page applies only to Glance releases prior to Ocata.  From Ocata
                onward, please see <reference internal="True" refuri="db#database-management"><inline classes="std std-ref">Database Management</inline></reference>.</paragraph>
        </note>
        <paragraph>The default metadata driver for Glance uses sqlalchemy, which implies there
            exists a backend database which must be managed. The <literal>glance-manage</literal> binary
            provides a set of commands for making this easier.</paragraph>
        <paragraph>The commands should be executed as a subcommand of ‘db’:</paragraph>
        <block_quote>
            <paragraph>glance-manage db &lt;cmd&gt; &lt;args&gt;</paragraph>
        </block_quote>
        <section ids="sync-the-database" names="sync\ the\ database">
            <title>Sync the Database</title>
            <block_quote>
                <paragraph>glance-manage db sync &lt;version&gt; &lt;current_version&gt;</paragraph>
            </block_quote>
            <paragraph>Place a database under migration control and upgrade, creating it first if necessary.</paragraph>
        </section>
        <section ids="determining-the-database-version" names="determining\ the\ database\ version">
            <title>Determining the Database Version</title>
            <block_quote>
                <paragraph>glance-manage db version</paragraph>
            </block_quote>
            <paragraph>This will print the current migration level of a Glance database.</paragraph>
        </section>
        <section ids="upgrading-an-existing-database" names="upgrading\ an\ existing\ database">
            <title>Upgrading an Existing Database</title>
            <block_quote>
                <paragraph>glance-manage db upgrade &lt;VERSION&gt;</paragraph>
            </block_quote>
            <paragraph>This will take an existing database and upgrade it to the specified VERSION.</paragraph>
        </section>
        <section ids="downgrading-an-existing-database" names="downgrading\ an\ existing\ database">
            <title>Downgrading an Existing Database</title>
            <paragraph>Upgrades involve complex operations and can fail. Before attempting any
                upgrade, you should make a full database backup of your production data. As of
                Kilo, database downgrades are not supported, and the only method available to
                get back to a prior database version is to restore from backup[1].</paragraph>
            <paragraph>[1]: <reference refuri="http://docs.openstack.org/ops-guide/ops-upgrades.html#perform-a-backup">http://docs.openstack.org/ops-guide/ops-upgrades.html#perform-a-backup</reference></paragraph>
        </section>
    </section>
</document>
