<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/nova/doc/source/user/launch-instance-from-volume.rst">
    <section ids="launch-an-instance-from-a-volume" names="launch\ an\ instance\ from\ a\ volume">
        <title>Launch an instance from a volume</title>
        <paragraph>You can boot instances from a volume instead of an image.</paragraph>
        <paragraph>To complete these tasks, use these parameters on the
            <literal_strong classes="command">openstack server create</literal_strong> command:</paragraph>
        <tabular_col_spec spec="|p{0.3\textwidth}|p{0.25\textwidth}|p{0.4\textwidth}|">
        </tabular_col_spec>
        <table classes="colwidths-given">
            <tgroup cols="3">
                <colspec colwidth="30"></colspec>
                <colspec colwidth="15"></colspec>
                <colspec colwidth="30"></colspec>
                <thead>
                    <row>
                        <entry>
                            <paragraph>Task</paragraph>
                        </entry>
                        <entry>
                            <paragraph>openstack server create parameter</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Information</paragraph>
                        </entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>
                            <paragraph>Boot an instance from an image and attach a non-bootable
                                volume.</paragraph>
                        </entry>
                        <entry>
                            <paragraph><literal>--block-device</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph><reference internal="True" refid="boot-instance-from-image-and-attach-non-bootable-volume"><inline classes="std std-ref">Boot instance from image and attach non-bootable volume</inline></reference></paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph>Create a volume from an image and boot an instance from that
                                volume.</paragraph>
                        </entry>
                        <entry>
                            <paragraph><literal>--block-device</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph><reference internal="True" refid="create-volume-from-image-and-boot-instance"><inline classes="std std-ref">Create volume from image and boot instance</inline></reference></paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph>Boot from an existing source image, volume, or snapshot.</paragraph>
                        </entry>
                        <entry>
                            <paragraph><literal>--block-device</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph><reference internal="True" refid="create-volume-from-image-and-boot-instance"><inline classes="std std-ref">Create volume from image and boot instance</inline></reference></paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph>Attach a swap disk to an instance.</paragraph>
                        </entry>
                        <entry>
                            <paragraph><literal>--swap</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph><reference internal="True" refid="attach-swap-or-ephemeral-disk-to-an-instance"><inline classes="std std-ref">Attach swap or ephemeral disk to an instance</inline></reference></paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph>Attach an ephemeral disk to an instance.</paragraph>
                        </entry>
                        <entry>
                            <paragraph><literal>--ephemeral</literal></paragraph>
                        </entry>
                        <entry>
                            <paragraph><reference internal="True" refid="attach-swap-or-ephemeral-disk-to-an-instance"><inline classes="std std-ref">Attach swap or ephemeral disk to an instance</inline></reference></paragraph>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <note>
            <paragraph>To attach a volume to a running instance, see
                <reference name="Attach a volume to an instance" refuri="https://docs.openstack.org/cinder/latest/cli/cli-manage-volumes.html#attach-a-volume-to-an-instance">Attach a volume to an instance</reference>.</paragraph>
        </note>
        <target ids="attach-a-volume-to-an-instance" names="attach\ a\ volume\ to\ an\ instance" refuri="https://docs.openstack.org/cinder/latest/cli/cli-manage-volumes.html#attach-a-volume-to-an-instance"></target>
        <target refid="boot-instance-from-image-and-attach-non-bootable-volume"></target>
        <section ids="boot-instance-from-image-and-attach-non-bootable-volume id1" names="boot\ instance\ from\ image\ and\ attach\ non-bootable\ volume boot_instance_from_image_and_attach_non-bootable_volume">
            <title>Boot instance from image and attach non-bootable volume</title>
            <paragraph>Create a non-bootable volume and attach that volume to an instance that
                you boot from an image.</paragraph>
            <paragraph>To create a non-bootable volume, do not create it from an image. The
                volume must be entirely empty with no partition table and no file
                system.</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Create a non-bootable volume.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume create --size 8 my-volume
+---------------------+--------------------------------------+
| Field               | Value                                |
+---------------------+--------------------------------------+
| attachments         | []                                   |
| availability_zone   | nova                                 |
| bootable            | false                                |
| consistencygroup_id | None                                 |
| created_at          | 2016-11-25T10:37:08.850997           |
| description         | None                                 |
| encrypted           | False                                |
| id                  | b8f7bbec-6274-4cd7-90e7-60916a5e75d4 |
| migration_status    | None                                 |
| multiattach         | False                                |
| name                | my-volume                            |
| properties          |                                      |
| replication_status  | disabled                             |
| size                | 8                                    |
| snapshot_id         | None                                 |
| source_volid        | None                                 |
| status              | creating                             |
| type                | None                                 |
| updated_at          | None                                 |
| user_id             | 0678735e449149b0a42076e12dd54e28     |
+---------------------+--------------------------------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>List volumes.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume list
+--------------------------------------+--------------+-----------+------+-------------+
| ID                                   | Display Name | Status    | Size | Attached to |
+--------------------------------------+--------------+-----------+------+-------------+
| b8f7bbec-6274-4cd7-90e7-60916a5e75d4 | my-volume    | available |    8 |             |
+--------------------------------------+--------------+-----------+------+-------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Boot an instance from an image and attach the empty volume to the
                        instance.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server create --flavor 2 --image 98901246-af91-43d8-b5e6-a4506aa8f369 \
  --block-device source=volume,id=d620d971-b160-4c4e-8652-2513d74e2080,dest=volume,shutdown=preserve \
  myInstanceWithVolume
+--------------------------------------+--------------------------------------------+
| Field                                | Value                                      |
+--------------------------------------+--------------------------------------------+
| OS-DCF:diskConfig                    | MANUAL                                     |
| OS-EXT-AZ:availability_zone          | nova                                       |
| OS-EXT-SRV-ATTR:host                 | -                                          |
| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                          |
| OS-EXT-SRV-ATTR:instance_name        | instance-00000004                          |
| OS-EXT-STS:power_state               | 0                                          |
| OS-EXT-STS:task_state                | scheduling                                 |
| OS-EXT-STS:vm_state                  | building                                   |
| OS-SRV-USG:launched_at               | -                                          |
| OS-SRV-USG:terminated_at             | -                                          |
| accessIPv4                           |                                            |
| accessIPv6                           |                                            |
| adminPass                            | ZaiYeC8iucgU                               |
| config_drive                         |                                            |
| created                              | 2014-05-09T16:34:50Z                       |
| flavor                               | m1.small (2)                               |
| hostId                               |                                            |
| id                                   | 1e1797f3-1662-49ff-ae8c-a77e82ee1571       |
| image                                | cirros-0.3.5-x86_64-uec (98901246-af91-... |
| key_name                             | -                                          |
| metadata                             | {}                                         |
| name                                 | myInstanceWithVolume                       |
| os-extended-volumes:volumes_attached | [{"id": "d620d971-b160-4c4e-8652-2513d7... |
| progress                             | 0                                          |
| security_groups                      | default                                    |
| status                               | BUILD                                      |
| tenant_id                            | ccef9e62b1e645df98728fb2b3076f27           |
| updated                              | 2014-05-09T16:34:51Z                       |
| user_id                              | fef060ae7bfd4024b3edb97dff59017a           |
+--------------------------------------+--------------------------------------------+</literal_block>
                </list_item>
            </enumerated_list>
            <target refid="create-volume-from-image-and-boot-instance"></target>
        </section>
        <section ids="create-volume-from-image-and-boot-instance id2" names="create\ volume\ from\ image\ and\ boot\ instance create_volume_from_image_and_boot_instance">
            <title>Create volume from image and boot instance</title>
            <paragraph>You can create a volume from an existing image, volume, or snapshot.
                This procedure shows you how to create a volume from an image, and use
                the volume to boot an instance.</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>List the available images.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack image list
+-----------------+---------------------------------+--------+
| ID              | Name                            | Status |
+-----------------+---------------------------------+--------+
| 484e05af-a14... | Fedora-x86_64-20-20131211.1-sda | active |
| 98901246-af9... | cirros-0.3.5-x86_64-uec         | active |
| b6e95589-7eb... | cirros-0.3.5-x86_64-uec-kernel  | active |
| c90893ea-e73... | cirros-0.3.5-x86_64-uec-ramdisk | active |
+-----------------+---------------------------------+--------+</literal_block>
                    <paragraph>Note the ID of the image that you want to use to create a volume.</paragraph>
                    <paragraph>If you want to create a volume to a specific storage backend, you need
                        to use an image which has <emphasis>cinder_img_volume_type</emphasis> property.
                        In this case, a new volume will be created as <emphasis>storage_backend1</emphasis> volume
                        type.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack image show 98901246-af9d-4b61-bea8-09cc6dc41829
+------------------+------------------------------------------------------+
| Field            | Value                                                |
+------------------+------------------------------------------------------+
| checksum         | ee1eca47dc88f4879d8a229cc70a07c6                     |
| container_format | bare                                                 |
| created_at       | 2016-10-08T14:59:05Z                                 |
| disk_format      | qcow2                                                |
| file             | /v2/images/9fef3b2d-c35d-4b61-bea8-09cc6dc41829/file |
| id               | 98901246-af9d-4b61-bea8-09cc6dc41829                 |
| min_disk         | 0                                                    |
| min_ram          | 0                                                    |
| name             | cirros-0.3.5-x86_64-uec                              |
| owner            | 8d8ef3cdf2b54c25831cbb409ad9ae86                     |
| protected        | False                                                |
| schema           | /v2/schemas/image                                    |
| size             | 13287936                                             |
| status           | active                                               |
| tags             |                                                      |
| updated_at       | 2016-10-19T09:12:52Z                                 |
| virtual_size     | None                                                 |
| visibility       | public                                               |
+------------------+------------------------------------------------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>List the available flavors.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack flavor list
+-----+-----------+-------+------+-----------+-------+-----------+
| ID  | Name      |   RAM | Disk | Ephemeral | VCPUs | Is_Public |
+-----+-----------+-------+------+-----------+-------+-----------+
| 1   | m1.tiny   |   512 |    1 |         0 |     1 | True      |
| 2   | m1.small  |  2048 |   20 |         0 |     1 | True      |
| 3   | m1.medium |  4096 |   40 |         0 |     2 | True      |
| 4   | m1.large  |  8192 |   80 |         0 |     4 | True      |
| 5   | m1.xlarge | 16384 |  160 |         0 |     8 | True      |
+-----+-----------+-------+------+-----------+-------+-----------+</literal_block>
                    <paragraph>Note the ID of the flavor that you want to use to create a volume.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>To create a bootable volume from an image and launch an instance from
                        this volume, use the <literal>--block-device</literal> parameter.</paragraph>
                    <paragraph>For example:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server create --flavor FLAVOR --block-device \
  source=SOURCE,id=ID,dest=DEST,size=SIZE,shutdown=PRESERVE,bootindex=INDEX \
  NAME</literal_block>
                    <paragraph>The parameters are:</paragraph>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph><literal>--flavor</literal>
                                The flavor ID or name.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph><literal>--block-device</literal>
                                source=SOURCE,id=ID,dest=DEST,size=SIZE,shutdown=PRESERVE,bootindex=INDEX</paragraph>
                            <definition_list>
                                <definition_list_item>
                                    <term><strong>source=SOURCE</strong></term>
                                    <definition>
                                        <paragraph>The type of object used to create the block device. Valid values
                                            are <literal>volume</literal>, <literal>snapshot</literal>, <literal>image</literal>, and <literal>blank</literal>.</paragraph>
                                    </definition>
                                </definition_list_item>
                                <definition_list_item>
                                    <term><strong>id=ID</strong></term>
                                    <definition>
                                        <paragraph>The ID of the source object.</paragraph>
                                    </definition>
                                </definition_list_item>
                                <definition_list_item>
                                    <term><strong>dest=DEST</strong></term>
                                    <definition>
                                        <paragraph>The type of the target virtual device. Valid values are <literal>volume</literal>
                                            and <literal>local</literal>.</paragraph>
                                    </definition>
                                </definition_list_item>
                                <definition_list_item>
                                    <term><strong>size=SIZE</strong></term>
                                    <definition>
                                        <paragraph>The size of the volume that is created.</paragraph>
                                    </definition>
                                </definition_list_item>
                                <definition_list_item>
                                    <term><strong>shutdown={preserve|remove}</strong></term>
                                    <definition>
                                        <paragraph>What to do with the volume when the instance is deleted.
                                            <literal>preserve</literal> does not delete the volume. <literal>remove</literal> deletes the
                                            volume.</paragraph>
                                    </definition>
                                </definition_list_item>
                                <definition_list_item>
                                    <term><strong>bootindex=INDEX</strong></term>
                                    <definition>
                                        <paragraph>Orders the boot disks. Use <literal>0</literal> to boot from this volume.</paragraph>
                                    </definition>
                                </definition_list_item>
                            </definition_list>
                        </list_item>
                        <list_item>
                            <paragraph><literal>NAME</literal>. The name for the server.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Create a bootable volume from an image. Cinder makes a volume bootable
                        when <literal>--image</literal> parameter is passed.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume create --image IMAGE_ID --size SIZE_IN_GB bootable_volume</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Create a VM from previously created bootable volume. The volume is not
                        deleted when the instance is terminated.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server create --flavor 2 --volume VOLUME_ID \
  --block-device source=volume,id=$VOLUME_ID,dest=volume,size=10,shutdown=preserve,bootindex=0 \
  myInstanceFromVolume
+--------------------------------------+--------------------------------+
| Field                                | Value                          |
+--------------------------------------+--------------------------------+
| OS-EXT-STS:task_state                | scheduling                     |
| image                                | Attempt to boot from volume    |
|                                      | - no image supplied            |
| OS-EXT-STS:vm_state                  | building                       |
| OS-EXT-SRV-ATTR:instance_name        | instance-00000003              |
| OS-SRV-USG:launched_at               | None                           |
| flavor                               | m1.small                       |
| id                                   | 2e65c854-dba9-4f68-8f08-fe3... |
| security_groups                      | [{u'name': u'default'}]        |
| user_id                              | 352b37f5c89144d4ad053413926... |
| OS-DCF:diskConfig                    | MANUAL                         |
| accessIPv4                           |                                |
| accessIPv6                           |                                |
| progress                             | 0                              |
| OS-EXT-STS:power_state               | 0                              |
| OS-EXT-AZ:availability_zone          | nova                           |
| config_drive                         |                                |
| status                               | BUILD                          |
| updated                              | 2014-02-02T13:29:54Z           |
| hostId                               |                                |
| OS-EXT-SRV-ATTR:host                 | None                           |
| OS-SRV-USG:terminated_at             | None                           |
| key_name                             | None                           |
| OS-EXT-SRV-ATTR:hypervisor_hostname  | None                           |
| name                                 | myInstanceFromVolume           |
| adminPass                            | TzjqyGsRcJo9                   |
| tenant_id                            | f7ac731cc11f40efbc03a9f9e1d... |
| created                              | 2014-02-02T13:29:53Z           |
| os-extended-volumes:volumes_attached | [{"id": "2fff50ab..."}]        |
| metadata                             | {}                             |
+--------------------------------------+--------------------------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>List volumes to see the bootable volume and its attached
                        <literal>myInstanceFromVolume</literal> instance.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack volume list
+---------------------+-----------------+--------+------+---------------------------------+
| ID                  | Display Name    | Status | Size | Attached to                     |
+---------------------+-----------------+--------+------+---------------------------------+
| c612f739-8592-44c4- | bootable_volume | in-use |  10  | Attached to myInstanceFromVolume|
| b7d4-0fee2fe1da0c   |                 |        |      | on /dev/vda                     |
+---------------------+-----------------+--------+------+---------------------------------+</literal_block>
                </list_item>
            </enumerated_list>
            <target refid="attach-swap-or-ephemeral-disk-to-an-instance"></target>
        </section>
        <section ids="attach-swap-or-ephemeral-disk-to-an-instance id3" names="attach\ swap\ or\ ephemeral\ disk\ to\ an\ instance attach_swap_or_ephemeral_disk_to_an_instance">
            <title>Attach swap or ephemeral disk to an instance</title>
            <paragraph>Use the <literal>nova boot</literal> <literal>--swap</literal> parameter to attach a swap disk on boot
                or the <literal>nova boot</literal> <literal>--ephemeral</literal> parameter to attach an ephemeral
                disk on boot. When you terminate the instance, both disks are deleted.</paragraph>
            <paragraph>Boot an instance with a 512 MB swap disk and 2 GB ephemeral disk.</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ nova boot --flavor FLAVOR --image IMAGE_ID --swap 512 \
  --ephemeral size=2 NAME</literal_block>
            <note>
                <paragraph>The flavor defines the maximum swap and ephemeral disk size. You
                    cannot exceed these maximum values.</paragraph>
            </note>
        </section>
    </section>
</document>
