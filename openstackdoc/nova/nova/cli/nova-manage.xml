<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/nova/doc/source/cli/nova-manage.rst">
    <section ids="nova-manage" names="nova-manage">
        <title>nova-manage</title>
        <section ids="control-and-manage-cloud-computer-instances" names="control\ and\ manage\ cloud\ computer\ instances">
            <title>control and manage cloud computer instances</title>
            <field_list>
                <field>
                    <field_name>Author</field_name>
                    <field_body>
                        <paragraph><reference refuri="mailto:openstack@lists.openstack.org">openstack@lists.openstack.org</reference></paragraph>
                    </field_body>
                </field>
                <field>
                    <field_name>Date</field_name>
                    <field_body>
                        <paragraph>2017-01-15</paragraph>
                    </field_body>
                </field>
                <field>
                    <field_name>Copyright</field_name>
                    <field_body>
                        <paragraph>OpenStack Foundation</paragraph>
                    </field_body>
                </field>
                <field>
                    <field_name>Version</field_name>
                    <field_body>
                        <paragraph>15.0.0</paragraph>
                    </field_body>
                </field>
                <field>
                    <field_name>Manual section</field_name>
                    <field_body>
                        <paragraph>1</paragraph>
                    </field_body>
                </field>
                <field>
                    <field_name>Manual group</field_name>
                    <field_body>
                        <paragraph>cloud computing</paragraph>
                    </field_body>
                </field>
            </field_list>
            <section ids="synopsis" names="synopsis">
                <title>SYNOPSIS</title>
                <block_quote>
                    <paragraph>nova-manage &lt;category&gt; &lt;action&gt; [&lt;args&gt;]</paragraph>
                </block_quote>
            </section>
            <section ids="description" names="description">
                <title>DESCRIPTION</title>
                <paragraph>nova-manage controls cloud computing instances by managing shell selection, vpn connections, and floating IP address configuration. More information about OpenStack Nova is at <reference refuri="https://docs.openstack.org/developer/nova">https://docs.openstack.org/developer/nova</reference>.</paragraph>
            </section>
            <section ids="options" names="options">
                <title>OPTIONS</title>
                <paragraph>The standard pattern for executing a nova-manage command is:
                    <literal>nova-manage &lt;category&gt; &lt;command&gt; [&lt;args&gt;]</literal></paragraph>
                <paragraph>Run without arguments to see a list of available command categories:
                    <literal>nova-manage</literal></paragraph>
                <paragraph>You can also run with a category argument such as user to see a list of all commands in that category:
                    <literal>nova-manage db</literal></paragraph>
                <paragraph>These sections describe the available categories and arguments for nova-manage.</paragraph>
                <section ids="nova-database" names="nova\ database">
                    <title>Nova Database</title>
                    <paragraph><literal>nova-manage db version</literal></paragraph>
                    <block_quote>
                        <paragraph>Print the current main database version.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage db sync [--version &lt;version&gt;] [--local_cell]</literal></paragraph>
                    <block_quote>
                        <paragraph>Upgrade the main database schema up to the most recent version or
                            <literal>--version</literal> if specified. By default, this command will also attempt to
                            upgrade the schema for the cell0 database if it is mapped (see the
                            <literal>map_cell0</literal> or <literal>simple_cell_setup</literal> commands for more details on mapping
                            the cell0 database). If <literal>--local_cell</literal> is specified, then only the main
                            database in the current cell is upgraded. The local database connection is
                            determined by <literal>[database]/connection</literal> in the configuration file passed to
                            nova-manage.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage db archive_deleted_rows [--max_rows &lt;number&gt;] [--verbose] [--until-complete]</literal></paragraph>
                    <block_quote>
                        <paragraph>Move deleted rows from production tables to shadow tables. Specifying
                            --verbose will print the results of the archive operation for any tables
                            that were changed. Specifying --until-complete will make the command run
                            continuously until all deleted rows are archived. Use the --max_rows option,
                            which defaults to 1000, as a batch size for each iteration.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage db null_instance_uuid_scan [--delete]</literal></paragraph>
                    <block_quote>
                        <paragraph>Lists and optionally deletes database records where instance_uuid is NULL.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage db ironic_flavor_migration [--all] [--host] [--node] [--resource_class]</literal></paragraph>
                    <block_quote>
                        <paragraph>Perform the ironic flavor migration process against the database
                            while services are offline. This is <title_reference>not recommended</title_reference> for most
                            people. The ironic compute driver will do this online and as
                            necessary if run normally. This routine is provided only for
                            advanced users that may be skipping the 16.0.0 Pike release, never
                            able to run services normally at the Pike level. Since this utility
                            is for use when all services (including ironic) are down, you must
                            pass the resource class set on your node(s) with the
                            <literal>--resource_class</literal> parameter.</paragraph>
                        <paragraph>To migrate a specific host and node, provide the hostname and node uuid with
                            <literal>--host $hostname --node $uuid</literal>. To migrate all instances on nodes managed
                            by a single host, provide only <literal>--host</literal>. To iterate over all nodes in the
                            system in a single pass, use <literal>--all</literal>. Note that this process is not lightweight,
                            so it should not be run frequently without cause, although it is not harmful
                            to do so. If you have multiple cellsv2 cells, you should run this once per cell
                            with the corresponding cell config for each (i.e. this does not iterate cells
                            automatically).</paragraph>
                        <paragraph>Note that this is not recommended unless you need to run this
                            specific data migration offline, and it should be used with care as
                            the work done is non-trivial. Running smaller and more targeted batches (such as
                            specific nodes) is recommended.</paragraph>
                    </block_quote>
                </section>
                <section ids="nova-api-database" names="nova\ api\ database">
                    <title>Nova API Database</title>
                    <paragraph><literal>nova-manage api_db version</literal></paragraph>
                    <block_quote>
                        <paragraph>Print the current cells api database version.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage api_db sync</literal></paragraph>
                    <block_quote>
                        <paragraph>Sync the api cells database up to the most recent version. This is the standard way to create the db as well.</paragraph>
                    </block_quote>
                    <target refid="man-page-cells-v2"></target>
                </section>
                <section ids="nova-cells-v2 man-page-cells-v2" names="nova\ cells\ v2 man-page-cells-v2">
                    <title>Nova Cells v2</title>
                    <paragraph><literal>nova-manage cell_v2 simple_cell_setup [--transport-url &lt;transport_url&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>Setup a fresh cells v2 environment; this should not be used if you
                            currently have a cells v1 environment. Returns 0 if setup is completed
                            (or has already been done), 1 if no hosts are reporting (and cannot be
                            mapped), 1 if no transport url is provided for the cell message queue,
                            and 2 if run in a cells v1 environment.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 map_cell0 [--database_connection &lt;database_connection&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>Create a cell mapping to the database connection for the cell0 database.
                            If a database_connection is not specified, it will use the one defined by
                            <literal>[database]/connection</literal> in the configuration file passed to nova-manage.
                            The cell0 database is used for instances that have not been scheduled to
                            any cell. This generally applies to instances that have encountered an
                            error before they have been scheduled. Returns 0 if cell0 is created
                            successfully or already setup.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 map_instances --cell_uuid &lt;cell_uuid&gt; [--max-count &lt;max_count&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>Map instances to the provided cell. Instances in the nova database will
                            be queried from oldest to newest and mapped to the provided cell. A
                            max_count can be set on the number of instance to map in a single run.
                            Repeated runs of the command will start from where the last run finished
                            so it is not necessary to increase max-count to finish. Returns 0 if all
                            instances have been mapped, and 1 if there are still instances to be
                            mapped.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 map_cell_and_hosts [--name &lt;cell_name&gt;] [--transport-url &lt;transport_url&gt;] [--verbose]</literal></paragraph>
                    <block_quote>
                        <paragraph>Create a cell mapping to the database connection and message queue
                            transport url, and map hosts to that cell. The database connection
                            comes from the <literal>[database]/connection</literal> defined in the configuration
                            file passed to nova-manage. If a transport_url is not specified, it will
                            use the one defined by <literal>[DEFAULT]/transport_url</literal> in the configuration
                            file. This command is idempotent (can be run multiple times), and the
                            verbose option will print out the resulting cell mapping uuid. Returns 0
                            on successful completion, and 1 if the transport url is missing.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 verify_instance --uuid &lt;instance_uuid&gt; [--quiet]</literal></paragraph>
                    <block_quote>
                        <paragraph>Verify instance mapping to a cell. This command is useful to determine if
                            the cells v2 environment is properly setup, specifically in terms of the
                            cell, host, and instance mapping records required. Returns 0 when the
                            instance is successfully mapped to a cell, 1 if the instance is not
                            mapped to a cell (see the <literal>map_instances</literal> command), and 2 if the cell
                            mapping is missing (see the <literal>map_cell_and_hosts</literal> command if you are
                            upgrading from a cells v1 environment, and the <literal>simple_cell_setup</literal> if
                            you are upgrading from a non-cells v1 environment).</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 create_cell [--name &lt;cell_name&gt;] [--transport-url &lt;transport_url&gt;] [--database_connection &lt;database_connection&gt;] [--verbose]</literal></paragraph>
                    <block_quote>
                        <paragraph>Create a cell mapping to the database connection and message queue
                            transport url. If a database_connection is not specified, it will use
                            the one defined by <literal>[database]/connection</literal> in the configuration file
                            passed to nova-manage. If a transport_url is not specified, it will use
                            the one defined by <literal>[DEFAULT]/transport_url</literal> in the configuration file.
                            The verbose option will print out the resulting cell mapping uuid.
                            Returns 0 if the cell mapping was successfully created, 1 if the
                            transport url or database connection was missing, and 2 if a cell is
                            already using that transport url and database connection combination.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 discover_hosts [--cell_uuid &lt;cell_uuid&gt;] [--verbose] [--strict] [--by-service]</literal></paragraph>
                    <block_quote>
                        <paragraph>Searches cells, or a single cell, and maps found hosts. This command will
                            check the database for each cell (or a single one if passed in) and map any
                            hosts which are not currently mapped. If a host is already mapped nothing
                            will be done. You need to re-run this command each time you add more
                            compute hosts to a cell (otherwise the scheduler will never place instances
                            there and the API will not list the new hosts). If the strict option is
                            provided the command will only be considered successful if an unmapped host
                            is discovered (exit code 0). Any other case is considered a failure (exit
                            code 1). If --by-service is specified, this command will look in the
                            appropriate cell(s) for any nova-compute services and ensure there are host
                            mappings for them. This is less efficient and is only necessary when using
                            compute drivers that may manage zero or more actual compute nodes at any
                            given time (currently only ironic).</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 list_cells [--verbose]</literal></paragraph>
                    <block_quote>
                        <paragraph>Lists the v2 cells in the deployment. By default only the cell name and
                            uuid are shown. Use the --verbose option to see transport url and
                            database connection details.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 delete_cell [--force] --cell_uuid &lt;cell_uuid&gt;</literal></paragraph>
                    <block_quote>
                        <paragraph>Delete a cell by the given uuid. Returns 0 if the empty cell is
                            found and deleted successfully or the cell that has hosts is found and
                            the cell and the hosts are deleted successfully with <literal>--force</literal> option,
                            1 if a cell with that uuid could not be found, 2 if host mappings were
                            found for the cell (cell not empty) without <literal>--force</literal> option, and 3
                            if there are instances mapped to the cell (cell not empty).</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 update_cell --cell_uuid &lt;cell_uuid&gt; [--name &lt;cell_name&gt;] [--transport-url &lt;transport_url&gt;] [--database_connection &lt;database_connection&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>Updates the properties of a cell by the given uuid. If a
                            database_connection is not specified, it will attempt to use the one
                            defined by <literal>[database]/connection</literal> in the configuration file.  If a
                            transport_url is not specified, it will attempt to use the one defined
                            by <literal>[DEFAULT]/transport_url</literal> in the configuration file. If the cell
                            is not found by uuid, this command will return an exit code of 1. If
                            the properties cannot be set, this will return 2. Otherwise, the exit
                            code will be 0.</paragraph>
                        <paragraph>NOTE: Updating the transport_url or database_connection fields on
                            a running system will NOT result in all nodes immediately using the
                            new values. Use caution when changing these values.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage cell_v2 delete_host --cell_uuid &lt;cell_uuid&gt; --host &lt;host&gt;</literal></paragraph>
                    <block_quote>
                        <paragraph>Delete a host by the given host name and the given cell uuid. Returns 0
                            if the empty host is found and deleted successfully, 1 if a cell with
                            that uuid could not be found, 2 if a host with that name could not be
                            found, 3 if a host with that name is not in a cell with that uuid, 4 if
                            a host with that name has instances (host not empty).</paragraph>
                    </block_quote>
                </section>
                <section ids="nova-logs" names="nova\ logs">
                    <title>Nova Logs</title>
                    <versionmodified type="deprecated" version="16.0.0"><paragraph translatable="False"><inline classes="versionmodified">Deprecated since version 16.0.0: </inline>This will be removed in 17.0.0 (Queens)</paragraph></versionmodified>
                    <paragraph><literal>nova-manage logs errors</literal></paragraph>
                    <block_quote>
                        <paragraph>Displays nova errors from log files.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage logs syslog &lt;number&gt;</literal></paragraph>
                    <block_quote>
                        <paragraph>Displays nova alerts from syslog.</paragraph>
                    </block_quote>
                </section>
                <section ids="nova-shell" names="nova\ shell">
                    <title>Nova Shell</title>
                    <versionmodified type="deprecated" version="16.0.0"><paragraph translatable="False"><inline classes="versionmodified">Deprecated since version 16.0.0: </inline>This will be removed in 17.0.0 (Queens)</paragraph></versionmodified>
                    <paragraph><literal>nova-manage shell bpython</literal></paragraph>
                    <block_quote>
                        <paragraph>Starts a new bpython shell.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage shell ipython</literal></paragraph>
                    <block_quote>
                        <paragraph>Starts a new ipython shell.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage shell python</literal></paragraph>
                    <block_quote>
                        <paragraph>Starts a new python shell.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage shell run</literal></paragraph>
                    <block_quote>
                        <paragraph>Starts a new shell using python.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage shell script &lt;path/scriptname&gt;</literal></paragraph>
                    <block_quote>
                        <paragraph>Runs the named script from the specified path with flags set.</paragraph>
                    </block_quote>
                    <target refid="nova-manage-quota"></target>
                </section>
                <section ids="nova-quota nova-manage-quota" names="nova\ quota nova-manage-quota">
                    <title>Nova Quota</title>
                    <versionmodified type="deprecated" version="16.0.0"><paragraph translatable="False"><inline classes="versionmodified">Deprecated since version 16.0.0: </inline>This will be removed in 17.0.0 (Queens)</paragraph></versionmodified>
                    <paragraph><literal>nova-manage quota refresh</literal></paragraph>
                    <block_quote>
                        <paragraph>This command has been deprecated and is now a no-op since quota usage is
                            counted from resources instead of being tracked separately.</paragraph>
                    </block_quote>
                </section>
                <section ids="nova-project" names="nova\ project">
                    <title>Nova Project</title>
                    <versionmodified type="deprecated" version="16.0.0"><paragraph translatable="False"><inline classes="versionmodified">Deprecated since version 16.0.0: </inline>Much of this information is available over the API, with the exception of
                            the <literal>quota_usage_refresh</literal> command. Operators should use the <reference name="API" refuri="https://developer.openstack.org/api-ref/compute/#quota-sets-os-quota-sets">API</reference> for
                            all other operations.</paragraph><paragraph>This command group will be removed in 17.0.0 (Queens). The
                            <literal>quota_usage_refresh</literal> subcommand has been deprecated and is now a no-op
                            since quota usage is counted from resources instead of being tracked
                            separately.</paragraph></versionmodified>
                    <target ids="api" names="api" refuri="https://developer.openstack.org/api-ref/compute/#quota-sets-os-quota-sets"></target>
                    <paragraph><literal>nova-manage project quota &lt;project_id&gt; [--user &lt;user_id&gt;] [--key &lt;key&gt;] [--value &lt;value&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>Create, update or display quotas for project/user.  If a key is
                            not specified then the current usages are displayed.</paragraph>
                    </block_quote>
                    <paragraph><literal>nova-manage project quota_usage_refresh &lt;project_id&gt; [--user &lt;user_id&gt;] [--key &lt;key&gt;]</literal></paragraph>
                    <block_quote>
                        <paragraph>This command has been deprecated and is now a no-op since quota usage is
                            counted from resources instead of being tracked separately.</paragraph>
                    </block_quote>
                </section>
            </section>
            <section ids="see-also" names="see\ also">
                <title>SEE ALSO</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph><reference name="OpenStack Nova" refuri="https://docs.openstack.org/developer/nova">OpenStack Nova</reference></paragraph>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="bugs" names="bugs">
                <title>BUGS</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>Nova bugs are managed at Launchpad <reference name="Bugs : Nova" refuri="https://bugs.launchpad.net/nova">Bugs : Nova</reference></paragraph>
                    </list_item>
                </bullet_list>
            </section>
        </section>
    </section>
</document>
