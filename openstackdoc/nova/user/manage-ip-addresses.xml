<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/nova/doc/source/user/manage-ip-addresses.rst">
    <section ids="manage-ip-addresses" names="manage\ ip\ addresses">
        <title>Manage IP addresses</title>
        <target refid="index-0"></target>
        <todo_node classes="admonition-todo" ids="index-0">
            <title>Todo</title>
            <paragraph>This needs quite a bit of work since nova-network has been
                deprecated since Newton, and the network resource related compute
                APIs which are for nova-network or that proxy to neutron have been
                deprecated, along with their respective CLIs in python-novaclient.</paragraph>
        </todo_node>
        <paragraph>Each instance has a private, fixed IP address and can also have a
            public, or floating IP address. Private IP addresses are used for
            communication between instances, and public addresses are used for
            communication with networks outside the cloud, including the Internet.</paragraph>
        <paragraph>When you launch an instance, it is automatically assigned a private IP
            address that stays the same until you explicitly terminate the instance.
            Rebooting an instance has no effect on the private IP address.</paragraph>
        <paragraph>A pool of floating IP addresses, configured by the cloud administrator,
            is available in OpenStack Compute. The project quota defines the maximum
            number of floating IP addresses that you can allocate to the project.
            After you allocate a floating IP address to a project, you can:</paragraph>
        <bullet_list bullet="-">
            <list_item>
                <paragraph>Associate the floating IP address with an instance of the project. Only one
                    floating IP address can be allocated to an instance at any given time.</paragraph>
            </list_item>
            <list_item>
                <paragraph>Disassociate a floating IP address from an instance in the project.</paragraph>
            </list_item>
            <list_item>
                <paragraph>Delete a floating IP from the project which automatically deletes that IP's
                    associations.</paragraph>
            </list_item>
        </bullet_list>
        <paragraph>Use the <literal_strong classes="command">openstack</literal_strong> commands to manage floating IP addresses.</paragraph>
        <section ids="list-floating-ip-address-information" names="list\ floating\ ip\ address\ information">
            <title>List floating IP address information</title>
            <paragraph>To list all pools that provide floating IP addresses, run:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack floating ip pool list
+--------+
| name   |
+--------+
| public |
| test   |
+--------+</literal_block>
            <note>
                <paragraph>If this list is empty, the cloud administrator must configure a pool
                    of floating IP addresses.</paragraph>
            </note>
            <paragraph>To list all floating IP addresses that are allocated to the current project,
                run:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack floating ip list
+--------------------------------------+---------------------+------------------+------+
| ID                                   | Floating IP Address | Fixed IP Address | Port |
+--------------------------------------+---------------------+------------------+------+
| 760963b2-779c-4a49-a50d-f073c1ca5b9e | 172.24.4.228        | None             | None |
| 89532684-13e1-4af3-bd79-f434c9920cc3 | 172.24.4.235        | None             | None |
| ea3ebc6d-a146-47cd-aaa8-35f06e1e8c3d | 172.24.4.229        | None             | None |
+--------------------------------------+---------------------+------------------+------+</literal_block>
            <paragraph>For each floating IP address that is allocated to the current project,
                the command outputs the floating IP address, the ID for the instance
                to which the floating IP address is assigned, the associated fixed IP
                address, and the pool from which the floating IP address was
                allocated.</paragraph>
        </section>
        <section ids="associate-floating-ip-addresses" names="associate\ floating\ ip\ addresses">
            <title>Associate floating IP addresses</title>
            <paragraph>You can assign a floating IP address to a project and to an instance.</paragraph>
            <enumerated_list enumtype="arabic" prefix="" suffix=".">
                <list_item>
                    <paragraph>Run the following command to allocate a floating IP address to the
                        current project. By default, the floating IP address is allocated from
                        the public pool. The command outputs the allocated IP address:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack floating ip create public
+---------------------+--------------------------------------+
| Field               | Value                                |
+---------------------+--------------------------------------+
| created_at          | 2016-11-30T15:02:05Z                 |
| description         |                                      |
| fixed_ip_address    | None                                 |
| floating_ip_address | 172.24.4.236                         |
| floating_network_id | 0bf90de6-fc0f-4dba-b80d-96670dfb331a |
| headers             |                                      |
| id                  | c70ad74b-2f64-4e60-965e-f24fc12b3194 |
| port_id             | None                                 |
| project_id          | 5669caad86a04256994cdf755df4d3c1     |
| project_id          | 5669caad86a04256994cdf755df4d3c1     |
| revision_number     | 1                                    |
| router_id           | None                                 |
| status              | DOWN                                 |
| updated_at          | 2016-11-30T15:02:05Z                 |
+---------------------+--------------------------------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>List all project instances with which a floating IP address could be
                        associated.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server list
+---------------------+------+---------+------------+-------------+------------------+------------+
| ID                  | Name | Status  | Task State | Power State | Networks         | Image Name |
+---------------------+------+---------+------------+-------------+------------------+------------+
| d5c854f9-d3e5-4f... | VM1  | ACTIVE  | -          | Running     | private=10.0.0.3 | cirros     |
| 42290b01-0968-43... | VM2  | SHUTOFF | -          | Shutdown    | private=10.0.0.4 | centos     |
+---------------------+------+---------+------------+-------------+------------------+------------+</literal_block>
                </list_item>
                <list_item>
                    <paragraph>Associate an IP address with an instance in the project, as follows:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server add floating ip INSTANCE_NAME_OR_ID FLOATING_IP_ADDRESS</literal_block>
                    <paragraph>For example:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server add floating ip VM1 172.24.4.225</literal_block>
                    <paragraph>The instance is now associated with two IP addresses:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server list
+------------------+------+--------+------------+-------------+-------------------------------+------------+
| ID               | Name | Status | Task State | Power State | Networks                      | Image Name |
+------------------+------+--------+------------+-------------+-------------------------------+------------+
| d5c854f9-d3e5... | VM1  | ACTIVE | -          | Running     | private=10.0.0.3, 172.24.4.225| cirros     |
| 42290b01-0968... | VM2  | SHUTOFF| -          | Shutdown    | private=10.0.0.4              | centos     |
+------------------+------+--------+------------+-------------+-------------------------------+------------+</literal_block>
                    <paragraph>After you associate the IP address and configure security group rules
                        for the instance, the instance is publicly available at the floating IP
                        address.</paragraph>
                    <note>
                        <paragraph>The <literal_strong classes="command">openstack server</literal_strong> command does not allow users to associate a
                            floating IP address with a specific fixed IP address using the optional
                            <literal>--fixed-address</literal> parameter, which legacy commands required as an
                            argument.</paragraph>
                    </note>
                </list_item>
            </enumerated_list>
        </section>
        <section ids="disassociate-floating-ip-addresses" names="disassociate\ floating\ ip\ addresses">
            <title>Disassociate floating IP addresses</title>
            <paragraph>To disassociate a floating IP address from an instance:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack server remove floating ip INSTANCE_NAME_OR_ID FLOATING_IP_ADDRESS</literal_block>
            <paragraph>To remove the floating IP address from a project:</paragraph>
            <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ openstack floating ip delete FLOATING_IP_ADDRESS</literal_block>
            <paragraph>The IP address is returned to the pool of IP addresses that is available
                for all projects. If the IP address is still associated with a running
                instance, it is automatically disassociated from that instance.</paragraph>
        </section>
    </section>
</document>
